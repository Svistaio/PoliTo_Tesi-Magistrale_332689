
% !TEX root = ../../../Esperimenti/.tex/MEF.tex
% LTeX: language=it

\newcommand\width{10cm}
\pgfmathsetlengthmacro\height{0.618*\width}
\begin{tikzpicture}
    % \renewcommand\labelSize{10}
    % \renewcommand\tickSize{9}
    % \renewcommand\legendSize{9}

    \begin{axis}[
        name=Gamma,
        width=\width,height=\height,
        scale only axis,
        axis lines=left,
        domain=0:3,
        ymin=0,ymax=4.5,
        xmin=0,xmax=3,
        xlabel={\(x\)},ylabel={\(f(x)\)},
        xlabel style={font=\dimTesto{\labelSize}\color{white!15!black}},
        ylabel style={font=\dimTesto{\labelSize}\color{white!15!black}},
        xticklabel style={font=\dimTesto{\tickSize}},
        yticklabel style={font=\dimTesto{\tickSize}},
        extra x ticks={0.9},
        extra x tick labels={\dimTesto{7}\(\langle\hat\gamma\rangle\)},
        colormap/viridis,
        cycle list={[samples of colormap={8} of viridis]},
        legend pos=north east,
        legend cell align=left,
        legend style={
            font=\dimTesto{\legendSize},
            draw=none,
            fill=none,
            % nodes={
            %     scale=0.8,
            %     transform shape
            % }
        },
        grid=major,
        grid style={
            dashed,
            gray!20
        }
    ]

        \pgfmathsetmacro\mi{0.9}

        \foreach \a in {100, 40, 20, 10, 5, 2.5, 1.5, 1.1}{
            \addplot+[
                thick, 
                no marks,
            ] gnuplot [raw gnuplot] {
                set samples 300;
                f(x,a,b)=(1/(b**a * gamma(a))) * x**(a-1) * exp(-x/b);
                mi = \mi; a = \a; b = mi/a;
                plot [x=0:3] f(x,a,b);
            };

            \pgfmathparse{\a==100?1:0}
            \ifnum\pgfmathresult=1
                \addplot [draw=none,forget plot] gnuplot [raw gnuplot] {
                    f(x,a,b)=(1/(b**a * gamma(a))) * x**(a-1) * exp(-x/b);
                    mi = \mi; a = \a; b = mi/a;
                    plot "+" using (mi):(f(mi,a,b)) with points;
                } coordinate (PiccoMedia); 
            \fi
            
            \pgfmathsetmacro\skewness{2/sqrt(\a)}
            \addlegendentryexpanded{
                \makebox[4em][l]{$\alpha=\a$} 
                $\rho\approx\pgfmathprintnumber[
                    fixed,
                    precision=2,
                    fixed zerofill
                ]{\skewness}$
            }
        }

        \draw [thick,dashed,black] (axis cs:\mi,0) -- (PiccoMedia);
            % node[pos=1,right,xshift=0.25em] {\dimTesto{9}$\langle\hat\gamma\rangle=0.9$};

    \end{axis}

    \redefineTikZbounds{Gamma}{Gamma}
\end{tikzpicture}