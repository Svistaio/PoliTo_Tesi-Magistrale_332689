
% !TEX root = ../Testa/Principale.tex
% LTeX: language=it

\chapter[Teoria cinetica dei sistemi multiagente]{\texorpdfstring
    {Teoria cinetica dei\newline sistemi multiagente}
    {Teoria cinetica dei sistemi multiagente}%
}\label{secTCSM}

    In questo capitolo è discussa la \TCSMA{} necessaria per ottenere e discutere i risultati nel \cref{secSimulazioni}. S'inizia prima dando delle nozioni generali di teoria della probabilità colle quali si deriva successivamente la celeberrima equazione di Boltzmann a partire da una descrizione stocastica delle particelle di un gas; quindi si passa a generalizzare tali risultati per mediare le interazioni tramite una struttura topologica sottostante gli agenti, sia in modo esatto che approssimato; successivamente si descrivono le equazioni cinetiche nel caso corrente; infine si conclude analizzando le ipotesi semplificative che portano dalla presente teoria a quella classica di Boltzmann.
                
    % che equivale all'equazione di tipo Boltzmann con interazioni simmetriche \daRivedere{} usata classicamente per modellizzare la distribuzione dell'energia cinetica tra una popolazione di particelle di un gas.

    \section{Definizioni preliminari di probabilità}\label{secDefinizioniPreliminariProbabilitàTCSMA}

        Si annoverano ora alcuni concetti e risultati di teoria della probabilità avvisando, però, che per molti di essi è impossibile entrare eccessivamente nei dettagli senza spiegare un intero corso; in ogni caso si rimanda a \cite{Durrett2019PTE} per gl'interessati.

        \begin{dfn}[Semiretta intera/reale positiva]
            In tutto questo elaborato si fanno uso dei seguenti sottinsiemi dei numeri reali e naturali:
            %
            \begin{equation*} % https://en.wikipedia.org/wiki/Positive_real_numbers
                % \label{eqRplusRplusStar}
                \begin{aligned}
                    \RPlus&\equiv\{x\in\mathbb R\ \colon\ x\ge0\}\subset\mathbb R,\\
                    % \RPlusStar&\equiv\{x\in\mathbb R\ \colon\ x>0\},\\
                    \NPlus&\equiv\{n\in\mathbb N\ \colon\ n\geq1\}\subset\mathbb N.
                \end{aligned}
            \end{equation*}
        \end{dfn}

        \begin{dfn}[Variabile aleatoria]
            \label{defVariabileAleatoria}
            Una variabile aleatoria \(X\) è una funzione misurabile \(X\colon\Omega\to\mathbb R\), il cui dominio è uno spazio astratto \(\Omega\) di eventi; quest'ultimo definisce a sua volta uno spazio di probabilità \((\Omega,\mathcal F,\mathbb P)\) composto da una \(\sigma\)-algebra \(\mathcal F\) e una misura \(\mathbb P\) di massa unitaria.

            Siccome \(\Omega\) è uno spazio astratto poco trattabile, in questo scritto si definisce una variabile aleatoria semplicemente evidenziando l'appartenenza al suo codominio e sottintendendo il suo dominio: \(X\in\mathbb R\).
        \end{dfn}

        \begin{dfn}[Densità di probabilità di X]
            \label{defDensitàProbabilità}
            Sia \(X\in\mathbb R\) una variabile aleatoria assolutamente continua, allora la densità di probabilità \(f_X\colon\mathbb R\to\RPlus\) è una funzione misurabile che rappresenta la legge \(\mathbb P_X\) di \(X\):
            \[
                \mathbb P_X(A)=\mathbb P(X\in A)=\int_Af_X(x)\de x
                \quad\forall A\subseteq\mathbb R\text{ misurabile}.
            \]
            % e soddisfà la condizione di normalità
            % \[
            %     \mathbb P_X(\mathbb R)=\mathbb P(X\in\mathbb R)=\int_{\mathbb R}f_X(x)\de x=1
            %     \quad\forall t\in[0,+\infty).
            % \]
        \end{dfn}

        \begin{oss}
            Nella definizione precedente si assume che la variabile aleatoria \(X\) sia assolutamente continua, in tal modo \(f_X(x)\) è la sua derivata di Radon-Nikodym, ma la teoria sviluppata in questo paragrafo vale anche per misure piú astratte rispetto le quali \(f_X(x)dv\) va inteso come \(f_X(dv)\).
        \end{oss}

        \begin{dfn}[Densità congiunta di probabilità di \(\mathbf X\)]
            \label{defDensitàCongiuntaProbabilità}
            Siano \(n\in\mathbb N^+\) e \[\mathbf X=(X_1,X_2,\ldots,X_n)\in\mathbb R^n\] un vettore aleatorio assolutamente continuo, allora la densità congiunta di probabilità \(f_{\mathbf X}\colon\mathbb R^n\to\RPlus\) è una funzione misurabile che rappresenta la legge \(\mathbb P_{\mathbf X}\) di \(\mathbf X\):
            \[
                \begin{aligned}
                    \mathbb P_{\mathbf X}(A)&=\mathbb P(\mathbf X\in A)
                    =\int_Af_{\mathbf X}(\mathbf x)\de\mathbf x\\
                    &=\int_Af_{\mathbf X}(\mathbf x)\de x_1\de x_2\cdots\de x_n
                    \quad\forall A\subseteq\mathbb R^n\text{ misurabile}.
                \end{aligned}
            \]
            % e soddisfà la condizione di normalità
            % \[
            %     \int_{\mathbb R}f_{\mathbf X}(\mathbf x)\de\mathbf x
            %     =\int_{\mathbb R}f_{\mathbf X}(\mathbf x)\de x_1\de x_2\cdots\de x_n
            %     =1\quad\forall t.
            % \]
        \end{dfn}
        
        \begin{dfn}[Densità marginale di probabilità di \(\mathbf X\)]
            \label{defDensitàMarginaleProbabilità}
            Siano \(n\in\mathbb N^+\) e \(\mathbf X\in\mathbb R^n\) un vettore aleatorio assolutamente continuo, allora la densità marginale di probabilità \(f_{X_i}\colon\mathbb R\to\RPlus\) è una funzione misurabile cosí definita:
            %
            \begin{equation}
                \label{eqDensitàMarginaleProbabilità}
                f_{X_i}(x_i)=\int_{\mathbb R^{n-1}}
                f_{\mathbf X}(\mathbf x)\de x_1\de x_2\cdots\de x_{i-1}\de x_{i+1}\cdots\de x_n
                \quad\forall i\in\{1,2,\cdots,n\};
            \end{equation}
            %
            essa è a tutti gli effetti la densità di probabilità della variabile aleatoria \(X_i\) secondo la \cref{defDensitàProbabilità}.
        \end{dfn}

        \begin{oss}
            Per brevità, da qui in avanti s'indicheranno le precedenti densità sottintendendo che siano relative alla probabilità: \(f_X\) è dunque la densità di \(X\), \(f_{\mathbf X}\) la densità congiunta di \(\mathbf X\) e \(f_{X_i}\) la densità marginale di \(X_i\).

            Inoltre, qualora il contesto non dia ambiguità, si sottintendono le variabili o i vettori aleatori cui fanno riferimento le relative densità: dunque \(f\) è la densità di \(X\), \(\mathbf X\) e \(X_i\), a seconda del caso; in alternativa si possono usare anche forme piú leggere, come \(f_i\) per \(f_{X_i}\), se necessario.
        \end{oss}

        \begin{prt}[Densità congiunta di variabili aleatorie indipendenti]
            \label{prtDensitàCongiuntaIndipendente}
            Siano \(n\in\mathbb N^+\) e \(\mathbf X\in\mathbb R^n\) un vettore aleatorio assolutamente continuo, allora se tutte le variabili aleatorie che lo compongono sono tra loro indipendenti allora la densità congiunta di \(\mathbf X\) equivale alla produttoria di quelle marginali:
            \[
                X_i\independent X_j
                \ \forall i\neq j\in\{1,2,\ldots,n\}
                \ \ \implies\ \ 
                f_{\mathbf X}=\prod_{i=1}^nf_{X_i}.
            \]
        \end{prt}

        \begin{dfn}[Valore atteso]
            \label{defValoreAtteso}
            Sia \(X\in\mathbb R\) una variabile aleatoria assolutamente continua e data una funzione misurabile \(\varphi\colon\mathbb R\to\mathbb R\) arbitraria, allora il valore atteso di \(\varphi(X)\) è definito come
            \[
                \mathbb E[\varphi(X)]\equiv\int_{\mathbb R}\varphi(x)f_X(x)\de x,
            \]
            e un simile discorso vale anche per un vettore aleatorio ma con \(\varphi\colon\mathbb R^n\to\mathbb R\), preso \(n\in\mathbb N^+\):
            \[
                \mathbb E[\varphi(\mathbf X)]
                \equiv\int_{\mathbb R^n}\varphi(\mathbf x)f_{\mathbf X}(\mathbf x)\de\mathbf x
                =\int_{\mathbb R^n}\varphi(\mathbf x)f_{\mathbf X}(\mathbf x)\de x_1\de x_2\cdots\de x_n.
            \]
        \end{dfn}

        \begin{dfn}[Valore atteso condizionato]
            Sia \(X\in\mathbb R\) una variabile aleatoria assolutamente continua a media finita \(\mathbb E[X]\infty\) e sia \(\mathcal G\subseteq\mathcal F\) una sotto-\(\sigma\)-algebra, allora l'attesa di \(X\) condizionata a \(\mathcal G\) è una variabile aleatoria \(Y\) tale che

            \begin{enumerate}[
                label=AC\arabic*,
                topsep=0.5em,
                parsep=0em,
                itemsep=0.25em,
                leftmargin=3em,
                rightmargin=1.5em,
                % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                %itemindent=!,
                %labelindent=3em,
                %labelwidth=!,
                %labelsep=!,
            ]
                \item\label{ipAttesaCondizionataGMisurabile} \(\sigma(Y)\in\mathcal G\), ossia \(Y\) è \(\mathcal G\)-misurabile e
                \item\label{ipAttesaCondizionataUgualeMisura} per ogni \(A\in\mathcal G\) la misura di \(X\) e \(Y\) tramite \(\mathbb P\) è la stessa:
                    \[
                        \mathbb P(X\in A)=\int_AX\de\mathbb P=\int_AY\de\mathbb P=\mathbb P(Y\in A)
                    \]
            \end{enumerate}

            L'insieme delle \(Y\) che soddisfanno le \ref{ipAttesaCondizionataGMisurabile} e \ref{ipAttesaCondizionataUgualeMisura} sono indicate col simbolo \(\mathbb E[X|\mathcal G]\) che ne è anche il suo rappresentante; in effetti una generica \(Y\) si può indicare anche direttamente come \(\mathbb E[X|\mathcal G]\).

            Un'analoga definizione vale anche per i vettori aleatori e per i caso misti con \(X\) scalare e \(Y\) vettoriale.
        \end{dfn}

        \begin{oss}
            Presa una variabile aleatoria \(Y\in\mathbb R\), nella precedente definizione \(\mathcal G\) può essere anche la \(\sigma\)-algebra definita da \(Y\):
            \[
                \sigma(Y)\equiv\sigma({Y^{-1}(B)\ |\ B\in\mathcal B(\mathbb R)}),
            \]
            ove \(\mathcal B(\mathbb R)\) è la \(\sigma\)-algebra di Borel relativa allo spazio dei numeri reali mentre \(\sigma(A)\) è la piú piccola \(\sigma\)-algebra che contiene \(A\subset\RPlus(\Omega)\).

            Un simile risultato vale anche per i vettori aleatori \(\mathbf Y\in\mathbb R^n\).
        \end{oss}

        \begin{prp}
            \label{prpAttesaCondizionataInterpretazionePratica}
            Dati

            \begin{enumerate}[
                label=\arabic*.,
                topsep=0.5em,
                parsep=0em,
                itemsep=0.25em,
                leftmargin=2em,
                rightmargin=1.5em,
                % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                %itemindent=!,
                %labelindent=3em,
                %labelwidth=!,
                %labelsep=!,
            ]
                \item \(n,h,k\in\mathbb N_+\) tali che \(n=h+k\);
                \item un vettore aleatorio \(\mathbf Z=(\mathbf X,\mathbf Y)\in\mathbb R^n\) assolutamente continuo costituito da \(\mathbf X\in\mathbb R^h\) e \(\mathbf Y\in\mathbb R^k\) con densità congiunta \(f_{\mathbf Z}(\mathbf x,\mathbf y)\) e marginali \(f_{\mathbf X}\) e \(f_{\mathbf Y}\);
                \item una funzione \(\varphi\colon\mathbb R^n\to\mathbb R\) misurabile e tale che \[\mathbb E[\varphi(\mathbf Z)]=\mathbb E[\varphi(\mathbf X,\mathbf Y)]<\infty;\]
            \end{enumerate}

            allora si può definire \(h\colon\mathbb R^k\to\mathbb R\) tramite la seguente equazione
            %
            \begin{equation}
                \label{eqCondizionehVettoreAleatorio}
                \int_{\mathbb R^h}h(\mathbf y)f_{\mathbf Z}(\mathbf x,\mathbf y)\de\mathbf x
                =\int_{\mathbb R^h}\varphi(\mathbf x,\mathbf y)f_{\mathbf Z}(\mathbf x,\mathbf y)\de\mathbf x
                % =\mathbb E[\varphi(\mathbf X,\mathbf y)] % Non è corretto poiché la media necessita della densità delle variabili aleatorie al suo interno ma qui è presente solo quella relativa a Z
                \quad\forall\mathbf y\in\mathbb R^k,
            \end{equation}
            %
            che soddisfà \(h(\mathbf Y)\in\mathbb E[\varphi(\mathbf X,\mathbf Y)|\mathbf Y]\).
        \end{prp}
        
        \begin{proof}
            Per la \ref{ipAttesaCondizionataGMisurabile} è sufficiente esplicitare la forma di \(\sigma(h(\mathbf Y))\):
            \[
                \sigma(h(\mathbf Y))
                \equiv\sigma({\mathbf Y^{-1}(h^{-1}(B))\ |\ B\in\mathcal B(\mathbb R)})
                \subseteq\sigma({\mathbf Y^{-1}(B)\ |\ B\in\mathcal B(\mathbb R^h)}),
            \]
            a parole si considera la controimmagine tramite \(\mathbf Y\) dei borelliani filtrati da \(h\), ragion per cui la \(\sigma\)-algebra non potrà che essere contenuta in quella non filtrata.  
            
            Per la \ref{ipAttesaCondizionataUgualeMisura} si verifica la condizione \(\forall A\in\sigma(\mathbf Y)\) avvalendosi della caratterizzazione di \(h(\mathbf Y)\) tramite \eqref{eqCondizionehVettoreAleatorio}:
            \[
                \begin{aligned}
                    \int_Ah(\mathbf Y)\de\mathbb P
                    &=\int_Bh(\mathbf y)f_{\mathbf Y}(\mathbf y)\de\mathbf y
                    \overset{\eqref{eqDensitàMarginaleProbabilità}}{=}
                    \int_Bh(\mathbf y)\int_{\mathbb R^h}f_{\mathbf Z}(\mathbf x,\mathbf y)\de\mathbf x\de\mathbf y
                    \\&=\int_B\int_{\mathbb R^h}h(\mathbf y)f_{\mathbf Z}(\mathbf x,\mathbf y)\de\mathbf x\de\mathbf y
                    \overset{\eqref{eqCondizionehVettoreAleatorio}}{=}
                    \int_B\int_{\mathbb R^h}\varphi(\mathbf x,\mathbf y)f_{\mathbf Z}(\mathbf x,\mathbf y)\de\mathbf x\de\mathbf y
                    \\&=\int_{\mathbb R^n}\chi_B(\mathbf y)\varphi(\mathbf x,\mathbf y)f_{\mathbf Z}(\mathbf x,\mathbf y)\de\mathbf x\de\mathbf y
                    =\int_\Omega\chi_B(\mathbf Y)\varphi(\mathbf X,\mathbf Y)\de\mathbb P
                    \\&=\int_\Omega\chi_C(\mathbf Z)\varphi(\mathbf X,\mathbf Y)\de\mathbb P
                    =\int_\Omega\chi_A\varphi(\mathbf X,\mathbf Y)\de\mathbb P
                    =\int_A\varphi(\mathbf X,\mathbf Y)\de\mathbb P,
                \end{aligned}
            \] % P. 127 di «Probabilità II {29-09-2022}.pdf»
            ove \(\chi_A\), \(\chi_B\) e \(\chi_C\) sono funzioni indicatrici dei rispettivi insiemi, e in piú vale \(B\equiv\mathbf Y(A)\subseteq\mathbb R^k\) e \(C\equiv\mathbf Z(\mathbb R^h\times A)\subseteq\mathbb R^n\) dimodoché
            \[
                A=\mathbf Y^{-1}(B)=\mathbf Z^{-1}(C).
            \]
        \end{proof}

        \begin{oss}
            \label{ossAttesaCondizionataInterpretazionePratica}
            La precedente dimostrazione svela un'interpretazione piú pratica dell'attesa condizionata rispetto alla sua definizione alquanto teorica.

            Si consideri la \eqref{eqCondizionehVettoreAleatorio}, allora \(h(y)\) si può cosí riformulare:
            %
            \begin{equation}
                \label{eqAttesaCondizionataEvento}
                h(\mathbf y)
                =\int_{\mathbb R^h}\varphi(\mathbf x,\mathbf y)
                f_{\mathbf X|\mathbf Y=\mathbf y}(\mathbf x)\de\mathbf x
                =\mathbb E[\varphi(\mathbf X,\mathbf Y)|\mathbf Y=\mathbf y]
                \quad\forall\mathbf y\in\mathbb R^k,
            \end{equation}
            %
            in cui
            \[
                f_{\mathbf X|\mathbf Y=\mathbf y}
                \equiv\left\{
                    \begin{aligned}
                        &f_{\mathbf Z}(\mathbf x,\mathbf y)/f_{\mathbf Y}(\mathbf y)&\text{se }f_{\mathbf Y}(\mathbf y)\neq0\\
                        &0&\text{se }f_{\mathbf Y}(\mathbf y)=0
                    \end{aligned}
                \right.
            \]
            è la densità di \(\mathbf X\) condizionata dall'evento \(\mathbf Y=\mathbf y\).

            La \eqref{eqAttesaCondizionataEvento}, in pratica, si calcola svolgendo la media di \(\varphi(\mathbf X,\textbf Y)\) rispetto a \(\mathbf X\) dopo aver "fissato" l'evento \(\mathbf Y=\mathbf y\), vale a dire considerando la \(\mathbf Y\) come fosse un parametro uguale alla realizzazione \(\mathbf y\). 

            Successivamente, se s'impone \(A=\Omega\) (sempre lecito essendo \(\mathcal G\) una \(\sigma\)-al\-ge\-bra) allora dalla \ref{ipAttesaCondizionataUgualeMisura} vale
            %
            \begin{equation}
                \label{eqAttesaCondizionataInterpretazionePratica}
                \mathbb E[\varphi(\mathbf X,\mathbf Y)]
                =\mathbb E[\mathbb E[\varphi(\mathbf X,\mathbf Y)|\mathbf Y]],
            \end{equation}
            %
            il che significa che l'attesa di \(\varphi(\mathbf X,\mathbf Y)\) si calcola mediando rispetto a \(\mathbf Y\) la variabile aleatoria \(\mathbb E[\varphi(\mathbf X,\mathbf Y)|\mathbf Y]\), ricavata dalla \eqref{eqAttesaCondizionataEvento} ma considerando \(\mathbf y\) arbitrario.
        \end{oss}

        \begin{dfn}[Processo stocastico]
            \label{defProcessoStocastico}
            Data una dimensione \(n\in\mathbb\NPlus\), un processo stocastico è un insieme di vettori aleatori \(\mathbf X_t\) parametrizzati da un indice \(t\in I\subseteq\mathbb R\):
            \[
                \{\mathbf X_t\in\mathbb R^n\ |\ t\in I\}=\{\mathbf X_t\}_{t\in I},
            \]
            la cui densità congiunta è
            \[
                \mathbb P_{\mathbf X_t}(A)=\mathbb P(\mathbf X_t\in A)
                =\int_Af_{\mathbf X_t}(\mathbf x,t)\de\mathbf x
                \quad\forall A\subseteq\mathbb R^n\text{ misurabile}.
            \]
            Comunemente s'interpreta l'indice \(t\) come il tempo ponendo \(I\equiv\RPlus\), e cosí sarà fatto in questo scritto.
        \end{dfn}

    \section{Descrizione cinetica di [tipo] Boltzmann}\label{secDescrizioneCineticaClassicaETipoBoltzmann}

        \subsection{Equazione di Boltzmann omogenea}\label{secBoltzmannOmogeno}

            \subsubsection{Descrizione classica}

                Innanzitutto è necessario caratterizzare alcune proprietà del gas da modellizzare.

                \begin{ipo}
                    \label{ipGasPerfetto}
                    Si consideri un gas composto da particelle che soddisfaccia le successive importanti ipotesi:

                    \begin{enumerate}[
                        label=G\arabic*,
                        % topsep=0.5em,
                        % parsep=0em,
                        % itemsep=0.25em,
                        leftmargin=2em,
                        % rightmargin=1.5em,
                        % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                        %itemindent=!,
                        %labelindent=3em,
                        %labelwidth=!,
                        %labelsep=!,
                    ]
                        \item\label{ipGasOmogeneo} è uniformemente distribuito nello spazio cosicché in ogni punto la distribuzione statistica delle velocità è la stessa;
                        \item\label{ipGasRarefatto} è rarefatto, da cui segue che solo interazioni binarie possono aver luogo o, precisamente, sono piú frequenti;
                        \item\label{ipGasParticelleIndistinguibili} è composto da particelle indistinguibili e aventi ugual massa;
                        \item\label{ipGasCollisioniElastiche} le collisioni sono elastiche per cui si ha conservazione dell'impulso e dell'energia esprimibile, grazie alle \ref{ipGasRarefatto} e \ref{ipGasParticelleIndistinguibili}, binariamente come
                        %
                        \begin{align}
                            \mathbf v'+\mathbf v_*'
                            &=\mathbf v+\mathbf v_*,
                            \label{eqConservazioneImpulso}\tag{CI}\\
                            \vert\mathbf v'\vert^2+\vert \mathbf v_*'\vert^2&=
                            \vert\mathbf v\vert^2+\vert \mathbf v_*\vert^2,
                            \label{eqConservazioneEnergia}\tag{CE}
                        \end{align}
                        %
                        ove \(\mathbf v',\mathbf v'_*\in\mathbb R^3\) sono le velocità poscollisionali che collidono colle velocità precollisionali \(\mathbf v,\mathbf v_*\in\mathbb R^3\), delle due particelle interagenti\footnotemark{}.
                        \footnotetext{In questo contesto non è necessario distinguere quale delle due sia quella interagente e quale quella ricevente, contrariamente a quello delle città.}
                    \end{enumerate}
                \end{ipo}

                Dalla \ref{ipGasCollisioniElastiche} si possono in realtà esprimere le velocità poscollisionali a partire da quelle precollisionali, definendo quelle che sono le regole d'interazione.

                \begin{prp}[Regole d'interazione]\label{prpVelocitàCollisionali}
                    Esistono due funzioni \[\psi,\psi_*\colon\mathbb R^3\to\mathbb R^3\] lineari che soddisfanno \cref{eqConservazioneImpulso,eqConservazioneEnergia} e tali che
                    %
                    \begin{equation}
                        \label{eqRegoleInterazioneDeterministicheGas}
                        \begin{aligned}
                            \mathbf v'&=\psi(\mathbf v,\mathbf v_*)\equiv\mathbf v+[(\mathbf v_*-\mathbf v)\cdot n]n,\\
                            \mathbf v'_*&=\psi_*(\mathbf v,\mathbf v_*)\equiv\mathbf v_*+[(\mathbf v-\mathbf v_*)\cdot n]n,
                        \end{aligned}
                    \end{equation}
                    %
                    ove \(n\in\mathbb S^2\) è un qualunque vettore appartenente alla sfera unitaria di \(\mathbb R^3\).
                \end{prp}
                %
                \begin{proof}
                    Assumendo l'\textit{ansatz}
                    %
                    \begin{equation}
                        \label{eqAnsatzCollisioni}
                        \mathbf v'=\mathbf v-\gamma n\quad\text{ e }\quad\mathbf v'_*=\mathbf v_*+\gamma n,
                    \end{equation}
                    %
                    in cui \(\gamma\in\mathbb R\) è un parametro da determinare, si può notare che la \eqref{eqConservazioneImpulso} è già verificata, mentre imponendo la \eqref{eqConservazioneEnergia} si ha
                    \[
                        \begin{aligned}
                            \vert\mathbf v'\vert^2+\vert\mathbf v_*'\vert^2
                            &=\vert\mathbf v-\gamma n\vert^2+\vert\mathbf v_*+\gamma n\vert^2\\
                            &=(\mathbf v-\gamma n)\cdot(\mathbf v-\gamma n)
                            +(\mathbf v_*+\gamma n)\cdot(\mathbf v_*+\gamma n)\\
                            &=\vert\mathbf v\vert^2-2\gamma(\mathbf v\cdot n)
                            +\gamma^2+\vert\mathbf v_*\vert^2
                            +2\gamma(\mathbf v_*\cdot n)+\gamma^2\\
                            &=\vert\mathbf v\vert^2+\vert\mathbf v_*\vert^2
                            -2\gamma[(\mathbf v_*-\mathbf v)\cdot n+2\gamma]\\
                            &=\vert\mathbf v\vert^2+\vert\mathbf v_*\vert^2
                            \ \ \implies\ \ 
                            \gamma[(\mathbf v_*-\mathbf v)\cdot n+\gamma]=0,
                        \end{aligned}
                    \]
                    ma escludendo il caso banale di \(\gamma=0\) (nessuna interazione) si ha
                    \[
                        \gamma=\Gamma(\mathbf v,\mathbf v_*)\equiv(\mathbf v-\mathbf v_*)\cdot n,
                    \]
                    per cui \(\gamma\) è in realtà una funzione delle velocità precollisionali; la \eqref{eqAnsatzCollisioni} diventa allora
                    %
                    \begin{equation}
                        \label{eqVelocitàPoscollisionali}
                        \mathbf v'=\mathbf v+[(\mathbf v_*-\mathbf v)\cdot n]n
                        \quad\text{ e }\quad\mathbf v'_*
                        =\mathbf v_*+[(\mathbf v-\mathbf v_*)\cdot n]n.
                    \end{equation}
                \end{proof}
                %
                Si noti come la precedente dimostrazione lasci arbitrario \(n\in\mathbb S^2\), seppure da un punto di vista fisico sia ragionevole porlo parallelo al vettore passante per i centri delle particelle collidenti.

                Si osservi come le regole d'interazione nella \ref{eqRegoleInterazioneDeterministicheGas} sono bilineari e simmetriche secondo la seguente definzione:

                \begin{dfn}
                    \label{defLeggiInterazioneSimmetricheGas}
                    Se le regole d'interazione del tipo \eqref{eqRegoleInterazioneDeterministicheGas} verificano
                    \[
                        \begin{aligned}
                            \psi(\mathbf v,\mathbf v_*)&=\psi_*(\mathbf v_*,\mathbf v)\\
                            \psi_*(\mathbf v,\mathbf v_*)&=\psi(\mathbf v_*,\mathbf v)
                        \end{aligned}
                        \ \ \implies\ \ 
                        \begin{aligned}
                            \mathbf v'&=\psi_*(\mathbf v_*,\mathbf v)\\
                            \mathbf v'_*&=\psi(\mathbf v_*,\mathbf v)
                        \end{aligned}
                    \]
                    allora si dicono simmetriche.
                \end{dfn}

            \subsubsection{Descrizione statistica}

                Per proseguire è però necessaria una descrizione statistica del gas in esame: siano allora \(\{\mathbf V_t\}_{t\in\RPlus}\) e \(\{\mathbf V_t^*\}_{t\in\RPlus}\) i processi stocastici delle velocità precollisionali, dove \(\mathbf V_t,\mathbf V_t^*\in\mathbb R^3\) sono variabili aleatorie di cui le velocità precedenti, \(\mathbf v\) e \(\mathbf v_*\), sono due realizzazioni al tempo \(t\); un simile discorso vale per i processi stocastici delle velocità poscollisionali \(\{\mathbf V'_t\}_{t\in\RPlus}\) e \(\{\mathbf V^{*\prime}_t\}_{t\in\RPlus}\).

                \begin{oss}
                    \label{ossLeggiIndistinguibili}
                    Le variabili aleatorie \(\mathbf V_t\) e \(\mathbf V^*_t\) non sono indicizzate (per es. \(\mathbf V^i_t\)) proprio per l'indistinguibilità delle particelle assunta dalla \ref{ipGasParticelleIndistinguibili}, da cui si deduce anche che le leggi di \(\mathbf V_t\) e \(\mathbf V^*_t\) sono identiche:
                    \[
                        f_{\mathbf V_t}(\mathbf v,t)=f_{\mathbf V^*_t}(\mathbf v,t)=f(\mathbf v,t)\quad\forall \mathbf v\in\mathbb R^3.
                    \]
                \end{oss}

                Le regole d'interazione nella \eqref{eqRegoleInterazioneDeterministicheGas} diventano
                %
                \eqtag*{\([\text{RI}]_{\mathbf V}\)}{
                    \label{eqRegoleInterazioneGas}
                    [\text{RI}]_{\mathbf V}
                    \left\{\begin{aligned}
                        \mathbf V'&=\psi(\mathbf V,\mathbf V_*)\equiv\mathbf V+[(\mathbf V_*-\mathbf V)\cdot n]n,\\
                        \mathbf V'_*&=\psi_*(\mathbf V,\mathbf V_*)\equiv \mathbf V_*+[(\mathbf V-\mathbf V_*)\cdot n]n,
                    \end{aligned}\right.
                }%
                in cui anche \(n\) risulta aleatoriamente distribuito; usualmente s'ipotizza \(n\sim\mathcal U(\mathbb S^2)\), vale a dire che non vi sono direzioni preferenziali essendo queste uniformemente distribuite sulla sfera unitaria.

                Tuttavia l'interazione tra due particelle non è detto che avvenga, aspetto formulabile introducendo 
                %
                \eqtag{\([\text{Ber}]_{\mathbf V}\)}{
                    \label{eqBernoulliInterazioneGas}
                    \Theta\sim\DstrBernoulli(B((\mathbf V^*_t-\mathbf V_t)\cdot n)\Delta t)
                }%
                che è una variabile aleatoria di Bernoulli, indipendente da \(\mathbf V_t\) e \(\mathbf V^*_t\), la cui probabilità è descritta da due termini:
                
                \begin{enumerate}[
                    label=\arabic*.,
                    % topsep=0.5em,
                    % parsep=0em,
                    % itemsep=0.25em,
                    % leftmargin=2em,
                    % rightmargin=1.5em,
                    % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                    %itemindent=!,
                    %labelindent=3em,
                    %labelwidth=!,
                    %labelsep=!,
                ]
                    \item la funzione \(B\colon\mathbb R\to\RPlus\), detta nucleo di collisione, che permette d'avere una maggiore espressività sulle collisioni molecolari le quali possono influenzare il tasso d'interazione tra le molecole\footnotemark{};
                    \footnotetext{Si noti come \(B\) dipenda da \((\mathbf V_*-\mathbf V)\cdot n\), termine ripreso dalla \cref{prpVelocitàCollisionali}, cosa che permette d'interpretare \(n\) come la direzione lungo la quale le interazioni sono piú frequenti.}
                    \item un passo temporale \(\Delta t>0\) per discretizzare il tempo.
                \end{enumerate}
                
                \begin{oss}
                    \label{ossCondizioneTetaGas}
                    Per definizione di \(\Theta\), deve valere \(B((\mathbf V^*_t-\mathbf V_t)\cdot n)\Delta t\le1\) condizione soddisfacibile anche prendendo un passo temporale \(\Delta t\) adattivo; si vedrà tra poco, però, che, per quanto concerne il modello analitico, tale condizione sarà sempre verificata.
                \end{oss}

                Colle \ref{eqRegoleInterazioneGas} e \ref{eqBernoulliInterazioneGas}, lo stato dei due agenti al tempo \(t+\Delta t\) successivo è dunque dato dal seguente algoritmo d'interazione:
                %
                \eqtag*{\([\text{AR}]_{\mathbf V}\)}{
                    \label{eqAlgoritmoInterazioniGas}
                    [\text{AR}]_{\mathbf V}
                    \left\{\begin{aligned}
                        \mathbf V_{t+\Delta t}  &=(1-\Theta)\mathbf V_t+\Theta\mathbf V'_t,\\
                        \mathbf V^*_{t+\Delta t}&=(1-\Theta)\mathbf V^*_t+\Theta\mathbf V^{*\prime}_t,
                    \end{aligned}\right.
                }%
                che di fatto è una regola che descrive se gli agenti interagiscono a coppie (modellizzato dalla \(\Theta\)) e, nel caso, come interagiscono (modellizzato dalle \(\mathbf V'_t\) e \(\mathbf V^{*\prime}_t\)) modificando il loro stato al tempo successivo.

            \subsubsection{Derivazione modello}

                L'idea successiva, al fine di ricavare un modello dell'evoluzione di \(f\), è di mediare le \ref{eqAlgoritmoInterazioniGas} attraverso una funzione arbitraria \(\varphi\colon\mathbb R^3\to\mathbb R\), detta quantità osservabile, computabile dalle realizzazioni o di \(\mathbf V_{t+\Delta t}\) o di \(\mathbf V_{t+\Delta t}\); pertanto una volta applicato \(\varphi(\cdot)\) alle \ref{eqAlgoritmoInterazioniGas},
                %
                \begin{equation*}
                    \begin{aligned}
                        \varphi(\mathbf V_{t+\Delta t})&=\varphi((1-\Theta)\mathbf V_t+\Theta\mathbf V'_t),\\
                        \varphi(\mathbf V^*_{t+\Delta t})&=\varphi((1-\Theta)\mathbf V^*_t+\Theta\mathbf V^{*\prime}_t),
                    \end{aligned}
                \end{equation*}
                %
                e mediando \(\mathbb E[\cdot]\) si arriva a
                %
                \begin{equation*}
                    \begin{aligned}
                        \mathbb E[\varphi(\mathbf V_{t+\Delta t})]&=\mathbb E[\varphi((1-\Theta)\mathbf V_t+\Theta\mathbf V'_t)],\\
                        \mathbb E[\varphi(\mathbf V^*_{t+\Delta t})]&=\mathbb E[\varphi((1-\Theta)\mathbf V^*_t+\Theta\mathbf V^{*\prime}_t)];
                    \end{aligned}
                \end{equation*}
                %
                per espandere la media, siccome \(\Theta\) dipende da \((\mathbf V_t,\mathbf V^*_t,n)\), bisogna avvalersi dell'attesa condizionata, e in particolare della \cref{ossAttesaCondizionataInterpretazionePratica}, che porta a
                %
                \begin{equation}
                    \label{eqMediaCondizionataGas}
                    \begin{aligned}
                        \mathbb E[\varphi(\mathbf V_{t+\Delta t})]
                        =&\mathbb E[\varphi((1-\Theta)\mathbf V_t+\Theta\mathbf V'_t)],
                        \\=&\mathbb E[\mathbb E[\varphi((1-\Theta)\mathbf V_t+\Theta\mathbf V'_t)\ |\ \mathbf V_t,\mathbf V_t^*,n]],
                        \\=&\mathbb E[\varphi(\mathbf V_t)(1-B((\mathbf V^*_t-\mathbf V_t)\cdot n)\Delta t)]
                        \\&+\mathbb E[\varphi(\mathbf V'_t)B((\mathbf V^*_t-\mathbf V_t)\cdot n)]\Delta t,
                    \end{aligned}
                \end{equation}
                %
                e similmente per \(\mathbb E[\varphi(\mathbf V^*_{t+\Delta t})]\); riordinando i termini si ricava
                %
                \begin{equation*}
                    \begin{aligned}
                        \frac{\mathbb E[\varphi(\mathbf V_{t+\Delta t})]-\mathbb E[\varphi(\mathbf V_t)]}{\Delta t}
                        &=\mathbb E[B((\mathbf V^*_t-\mathbf V_t)\cdot n)(\varphi(\mathbf V'_t)-\varphi(\mathbf V_t))],\\
                        \frac{\mathbb E[\varphi(\mathbf V^*_{t+\Delta t})]-\mathbb E[\varphi(\mathbf V^*_t)]}{\Delta t}
                        &=\mathbb E[B((\mathbf V^*_t-\mathbf V_t)\cdot n)(\varphi(\mathbf V^{*\prime}_t)-\varphi(\mathbf V^*_t))],
                    \end{aligned}
                \end{equation*}
                %
                e passando formalmente al tempo continuo col limite \(\Delta t\to0^+\)\footnotemark{} si ha
                \footnotetext{Ciò permette di soddisfare la condizione descritta nel'\ref{ossCondizioneTetaGas} per qualunque valore di \(B((\mathbf V^*_t-\mathbf V_t)\cdot n)\).}
                %
                \begin{equation*}
                    \begin{aligned}
                        \derS{\mathbb E[\varphi(\mathbf V_t)]}t
                        &=\mathbb E[B((\mathbf V^*_t-\mathbf V_t)\cdot n)(\varphi(\mathbf V'_t)-\varphi(\mathbf V_t))],\\
                        \derS{\mathbb E[\varphi(\mathbf V^*_t)]}t
                        &=\mathbb E[B((\mathbf V^*_t-\mathbf V_t)\cdot n)(\varphi(\mathbf V^{*\prime}_t)-\varphi(\mathbf V^*_t))],
                    \end{aligned}
                \end{equation*}
                %
                che, dopo aver espanso i valori attesi secondo le loro definizioni, diventano
                %
                \begin{equation}
                    \label{eqInterazioniOsservabiliContinue}
                    \newcommand\hsep{\hspace{-.4em}}
                    \begin{aligned}
                        \derS{}t\int_{\mathbb R^3}\hsep
                        \varphi(\mathbf v)f(\mathbf v,t)\de\mathbf v
                        &=\int_{\mathbb R^6}\hsep\langle
                            B(\mathbf v,\mathbf v_*,n)
                            (\varphi(\mathbf v')-\varphi(\mathbf v))
                        \rangle f_{\mathbf V}(\mathbf v,\mathbf v_*,t)
                        \de\mathbf v\de\mathbf v_*,\\
                        \derS{}t\int_{\mathbb R^3}\hsep
                        \varphi(\mathbf v^*)f(\mathbf v_*,t)\de\mathbf v_*
                        &=\int_{\mathbb R^6}\hsep\langle
                            B(\mathbf v,\mathbf v_*,n)
                            (\varphi(\mathbf v_*')-\varphi(\mathbf v_*))
                        \rangle f_{\mathbf V}(\mathbf v,\mathbf v_*,t)
                        \de\mathbf v\de\mathbf v_*,
                    \end{aligned}
                \end{equation}
                %
                in cui
                \[
                    \langle\cdot\rangle\equiv\frac1{4\pi}\int_{\mathbb S^2}\cdot\de n
                \]
                indica la media rispetto a \(n\), \(B(\mathbf v,\mathbf v_*,n)\) è una forma breve per \(B((\mathbf v-\mathbf v_*)\cdot n)\) e si è posto \(\mathbf V\equiv(\mathbf V_t,\mathbf V^*_t)\) la cui densità congiunta è \(f_{\mathbf V}(\mathbf v,\mathbf v_*,t)\). È infine necessario sommare le due equazioni in \eqref{eqInterazioniOsservabiliContinue}. S'inizi dal primo membro:
                %
                \begin{equation}
                    \label{eqSommaPrimoMembroIOC}
                    \derS{}t\int_{\mathbb R^3}\varphi(\mathbf v)f(\mathbf v,t)\de\mathbf v+
                    \derS{}t\int_{\mathbb R^3}\varphi(\mathbf v^*)f(\mathbf v_*,t)\de\mathbf v_*
                    =2\derS{}t\int_{\mathbb R^3}\varphi(\mathbf v)f(\mathbf v,t)\de\mathbf v,
                \end{equation}
                %
                infatti dal'\cref{ossLeggiIndistinguibili} le due leggi sono di fatto identiche come lo è il dominio d'integrazione, quindi basta il cambio di variabile \(\mathbf v_*=\mathbf v\) nel secondo integrale per rendersi conto dell'equivalenza. Per il secondo membro sono necessarie due ulteriori fondamentali ipotesi:

                \begin{ipo}
                    \label{ipParitàTassoInterazioneGas}
                    Si assume che il nucleo di collisione sia una funzione pari:
                    %
                    \begin{equation}
                        \label{eqParitàNucleoCollisioneGas}
                        B((\mathbf v-\mathbf v_*)\cdot n)=B((\mathbf v_*-\mathbf v)\cdot n)
                        \quad\forall\mathbf v,\mathbf v_*\in\mathbb R^3;
                    \end{equation}
                    %
                    una scelta tipica è il valore assoluto \(\vert\cdot\vert\): \(B((\mathbf v-\mathbf v_*)\cdot n)\equiv\vert(\mathbf v-\mathbf v_*)\cdot n\vert\).
                \end{ipo}

                \begin{ipo}[Caos molecolare]
                    \label{ipCaoMolecolare}
                    Le particelle interagenti secondo le \ref{eqAlgoritmoInterazioniGas} sono campionante indipendentemente. Tal'ipotesi è piú facile da giustificare matematicamente che fisicamente perché semplifica di molto conti; in ogni caso, la \ref{ipGasRarefatto} la corrobora poiché in un gas rarefatto è naturale che se due particelle interagiscono, prima che ricollidano, avranno perso ogni vicendevole dipendenza a causa delle innumerevoli altre interazioni colle altre particelle.
                \end{ipo}

                \begin{oss}
                    Dal'\cref{ipCaoMolecolare}, unitamente alla \cref{prtDensitàCongiuntaIndipendente}, si deduce che la densità congiunta del vettore aleatorio \(\mathbf V\equiv(\mathbf V_t,\mathbf V^*_t)\) è data dal prodotto
                    \[
                        f_{\mathbf V}(\mathbf v,\mathbf v_*,t)
                        =f_{\mathbf V_t}(\mathbf v,t)f_{\mathbf V^*_t}(\mathbf v_*,t)
                        =f(\mathbf v,t)f(\mathbf v_*,t)
                        \quad\forall \mathbf v,\mathbf v_*\in\mathbb R^3.
                    \]
                \end{oss}

                In tal modo il termine moltiplicato a \(\varphi(v_*)\) nel secondo membro della seconda equazione della \eqref{eqInterazioniOsservabiliContinue} può essere cosí riformulato:
                %
                \begin{equation}
                    \label{eqSommaSecondoMembroIOC}
                    \int_{\mathbb R^6}\langle(\varphi(\mathbf v))
                    B(\mathbf v,\mathbf v_*,n)\rangle
                    f(\mathbf v,t)f(\mathbf v_*,t)\de\mathbf v\de\mathbf v_*,
                \end{equation}
                %
                seguendo la medesima logica della \eqref{eqSommaPrimoMembroIOC}. Applicando i due risultati illustrati nelle \cref{eqSommaPrimoMembroIOC,eqSommaSecondoMembroIOC} si perviene finalmente all'equazione di Bolztmann omogenea asimmetrica in forma debole:
                %
                \begin{equation}
                    \label{eqFormaDeboleBoltzmannOmogeneoAssimmetricoGas}
                    \derS{}t\int_{\mathbb R^3}\varphi f\de\mathbf v=
                    \frac1{4\pi}\int_{\mathbb R^6}\int_{\mathbb S^2}
                        B(\mathbf v,\mathbf v_*,n)
                        \left(\frac{\varphi'+\varphi'_*}2-\varphi\right)
                    ff_*\de n\de\mathbf v\de\mathbf v_*,
                \end{equation}
                %
                ove, per brevità di notazione, si sono sottintese le dipendenze per tutte le funzioni, espresse, salvo per il nucleo di collisione, da apici \(\prime\) e asterischi \(*\) (per una spiegazione piú dettagliata si legga poco dopo nel \cref{secTipoBoltzmannOmogeno}).
               
                Tuttavia, qualora le regole d'interazione siano simmetriche secondo la \cref{defLeggiInterazioneSimmetricheGas}, come in questo caso data la \cref{prpVelocitàCollisionali}, sempre con un cambio di variabili e sfruttando la parità del nucleo di collisione vale
                %
                \begin{equation*}
                    \int_{\mathbb R^6}\left(\left\langle
                        B(\mathbf v,\mathbf v_*,n)\varphi'
                    \right\rangle\right) ff_*\de\mathbf v\de\mathbf v_*,
                    =\int_{\mathbb R^6}\left(\left\langle
                        B(\mathbf v,\mathbf v_*,n)\varphi'_*
                    \right\rangle\right) ff_*\de\mathbf v\de\mathbf v_*,
                \end{equation*}
                %
                da cui segue l'equazione di Bolztmann omogenea simmetrica in forma debole\footnotemark{}:%
                \footnotetext{Si dice debole siccome essa vale per una una funzione \textit{test} \(\varphi\) arbitraria.}%
                %
                \eqtag{\([\text{EtB}]_{\mathbf V}\)}{
                    \label{eqFormaDeboleBoltzmannOmogeneoSimmetrico}
                    \derS{}t\int_{\mathbb R^3}\varphi f\de\mathbf v=
                    \frac1{4\pi}\int_{\mathbb R^6}\int_{\mathbb S^2}
                        B(\mathbf v,\mathbf v_*,n)
                        \left(\varphi'-\varphi\right)
                    ff_*\de n\de\mathbf v\de\mathbf v_*.
                }%
                Si può anche ricavare la forma forte della \ref{eqFormaDeboleBoltzmannOmogeneoSimmetrico} considerando le regole d'interazione inverse della \ref{eqRegoleInterazioneGas} \cite[§ 2.5, p. 15]{Loy2025EKTMAS}, ma il conto esula dagli scopi di questo elaborato; cionnonostante si riporta come riferimento per il paragrafo a venire:
                %
                \begin{equation}
                    \label{eqFormaForteBoltzmannOmogeneoSimmetrico}
                    \derP ft=\frac1{4\pi}\int_{\mathbb R^3}\int_{\mathbb S^2}
                    B(\mathbf v,\mathbf v_*,n)\left(f'f'_*-ff_*\right)\de n\de\mathbf v_*.
                \end{equation}

        \subsection{Equazione di Boltzmann disomogenea}\label{secBoltzmannDisomogeno}

            L'equazione originariamente ricavata da Boltzmann non è la \eqref{eqFormaForteBoltzmannOmogeneoSimmetrico}, bensí è quella disomogenea la cui unica differenza è la presenza di un termine avvettivo \(\mathbf v\cdot\nabla f\) a primo membro:
            %
            \begin{equation}
                \label{eqFormaForteBoltzmannDisomogeneoSimmetrico}
                \derP ft+\mathbf v\cdot\nabla f
                =\frac1{4\pi}\int_{\mathbb R^3}\int_{\mathbb S^2}
                B(\mathbf v,\mathbf v_*,n)\left(f'f'_*-ff_*\right)
                \de n\de\mathbf v_*,
            \end{equation}
            %
            dove l'operatore \(\nabla\equiv(\partial_{x_1},\partial_{x_2},\partial_{x_3})\) è il gradiente spaziale e la distribuzione dipende ora anche dallo spazio: \(f\equiv f(\mathbf x,\mathbf v,t)\). Essa è un'equazione integro-differenziale della distribuzione statistica delle posizioni e delle velocità a tempo dato.

            Il primo membro della \eqref{eqFormaForteBoltzmannDisomogeneoSimmetrico} non è altro che la derivata materiale della distribuzione \(f\): posto \(B(\mathbf v,\mathbf v_*,t)\equiv0\), ovvero in mancanza di collisioni, l'equazione involve in una del trasporto lineare con soluzione nota.
            
            \begin{prp}
                La soluzione dell'equazione del trasporto lineare
                %
                \begin{equation}
                    \label{eqTrasportoLineare}
                    \derP ft+\mathbf v\cdot\nabla f=0
                \end{equation}
                %
                ha come soluzione \(f(\mathbf x,\mathbf v,t)=f_0(\mathbf x-\mathbf vt,\mathbf v)\) in cui \(f_0=f(x,v,0)\) è la distribuzione iniziale.
            \end{prp}

            \begin{proof}
                Si procede usando il metodo delle caratteristiche: nella \eqref{eqTrasportoLineare} la velocità \(\mathbf v\) nell'operatore avvettivo non dipende né dallo spazio né dal tempo, quindi si possono prendere le curve \(\mathbf x(t)\) tali che
                %
                \begin{equation}
                    \label{eqCurveCaratteristiche}
                    \derS{\mathbf x}t=\mathbf v\ \ \implies\ \ \mathbf x(t)=\mathbf x_0+\mathbf vt
                \end{equation}
                %
                dette, appunto, curve caratteristiche della \eqref{eqTrasportoLineare}; valutando allora la distribuzione \(f(\mathbf x,\mathbf v,t)\) lungo di esse si può definire \(\hat f(t)=f(\mathbf x(t),\mathbf v,t)\) che derivata equivale a
                \[
                    \derS{\hat f}t=\derP ft+\nabla f\cdot\derS{\mathbf x}t=\derP ft+\mathbf v\cdot\nabla f=0
                    \ \ \implies\ \ \hat f(t)=\text{costante}\quad\forall t\geq0
                \]
                da cui si deduce che \(f\) è costante lungo le caratteristiche; ma dalla \eqref{eqCurveCaratteristiche} si può scrivere, trascurando la dipendenza dal tempo, \(\mathbf x_0=\mathbf x-\mathbf vt\), dunque la soluzione in un generico punto \((\mathbf x,\mathbf v,t)\) sarà data da
                \[
                    f(\mathbf x,\mathbf v,t)
                    =\hat f(t)=\hat f(0)
                    =f(\mathbf x_0,\mathbf v,0)
                    =f_0(\mathbf x_0,\mathbf v)
                    =f_0(\mathbf x-\mathbf vt,\mathbf v),
                \]
                considerando nella prima uguaglianza la caratteristica che al tempo \(t\) passa per \(\mathbf x\).
            \end{proof}

            Ciò significa che in assenza di collisioni la distribuzione iniziale \(f_0\) semplicemente trasla rigidamente nello spazio allo scorrere del tempo lungo la direzione della velocità costante \(\mathbf v\), movimento che rappresenta la variazione medi statistica delle posizioni molecolari.

            D'altra parte il secondo membro della \eqref{eqFormaForteBoltzmannDisomogeneoSimmetrico} rappresenta la variazione media statistica dalle velocità molecolari a causa delle collisioni (viene perciò anche chiamato operatore collisionale).
            
            Pertanto la \eqref{eqFormaForteBoltzmannDisomogeneoSimmetrico} descrive una chiara separazione di effetti: il primo membro altera solo la posizione delle particelle per il trasporto libero, mentre il secondo comporta esclusivamente variazioni della velocità per le collisioni.

            L'obbiettivo di Boltzmann tramite la \eqref{eqFormaForteBoltzmannDisomogeneoSimmetrico} era di raccordare due mondi: il mondo macroscopico, che all'equilibrio termodinamico restituisce quantità fisiche stazionarie e ben definite, e quello microscopico la cui descrizione molecolare implica una continua e caotica variazione delle stesse quantità fisiche anche in condizioni di equilibrio termodinamico (agitazione termica).

            Ciò è stato possibile grazie all'introduzione dei momenti statistici, ossia di quantità macroscopiche calcolabili a partire dalla distribuzione \(f\) soddisfacente la \eqref{eqFormaForteBoltzmannDisomogeneoSimmetrico}; i principali sono
            %
            \begin{equation}
                \label{eqPrincipaliMomentiBoltzmannGas}
                \begin{aligned}
                    \rho(\mathbf x,t)&\equiv\int_{\mathbb R^3}f(\mathbf x,\mathbf v,t)\de\mathbf v
                    &\text{densità,}\\
                    \mathbf u(\mathbf x,t)&\equiv\frac1{\rho(\mathbf x,t)}\int_{\mathbb R^3}\mathbf vf(\mathbf x,\mathbf v,t)\de\mathbf v
                    &\text{velocità massica,}\\
                    E(\mathbf x,t)&\equiv\frac1{\rho(\mathbf x,t)}\Vert\mathbf v\Vert^2\int_{\mathbb R^3}f(\mathbf x,\mathbf v,t)\de\mathbf v
                    &\text{energia totale,}\\
                    e(\mathbf x,t)&\equiv\frac1{\rho(\mathbf x,t)}\int_{\mathbb R^3}
                    \Vert\mathbf v-\mathbf u(\mathbf x,t)\Vert^2f(\mathbf x,\mathbf v,t)\de\mathbf v
                    &\text{energia interna,}\\
                    \theta(\mathbf x,t)&\equiv\frac13 e(\mathbf x,t)
                    &\text{temperatura.}
                \end{aligned}
            \end{equation}
            %
            Tali quantità sono definite da \(f\) seppure questa sia in genere infattibile da ricavare dalla \eqref{eqFormaForteBoltzmannDisomogeneoSimmetrico}, vista la difficile trattabilità analitica dell'equazione; eppure, tramite una sua attenta riformulazione in determinati regimi limite \cite{Loy2025EKTMAS,PareschiIMS2013}, è possibile svincolarsi del tutto dall'evoluzione puntuale della \(f\) ricavando un sistema chiuso dei soli momenti \eqref{eqPrincipaliMomentiBoltzmannGas}. La convergenza di questi a un valore stazionario è il nesso tra i due mondi attraverso la descrizione mesoscopica indotta dalla distribuzione \(f\). 

        \subsection{Equazione di tipo Boltzmann omogenea}\label{secTipoBoltzmannOmogeno}

            La derivazione dettagliata nel \cref{secBoltzmannOmogeno} è valida in realtà per una classe di problemi molto piú generali, detti di tipo Boltzmann omogenei, la cui teoria è stata sviluppata da Pareschi \etal{} \cite{PareschiIMS2013}; sono chiamati cosí per due ragioni:

            \begin{enumerate}[
                label=\arabic*.,
                topsep=0.5em,
                parsep=0em,
                itemsep=0.25em,
                leftmargin=2em,
                rightmargin=1.5em,
                % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                %itemindent=!,
                %labelindent=3em,
                %labelwidth=!,
                %labelsep=!,
            ]
                \item sono formulati per mezzo di equazioni integro-differenziali analoghe strutturalmente alla \ref{eqFormaDeboleBoltzmannOmogeneoSimmetrico} e
                \item sono applicati a contesti\footnotemark{} molto distanti da quello originale delle velocità di particelle di un gas.
                \footnotetext{Esempi importati sono quello sociofisico, come i vari modelli sulle opinioni, ed econofisico, come quello qui considerato delle città}
            \end{enumerate}
            
            Si ripropongono in questo paragrafo molti risultati analoghi a quelli già visti nel \cref{secBoltzmannOmogeno} senza però riscrivere tutt'i passaggi.

            \subsubsection{Descrizione e derivazione}

                Sia \(\{\mathbf X_t\}_{t\in\RPlus}\) il processo stocastico relativo allo stato microscopico dell'agente di un sistema, dove \(\mathbf X_t\in I\subseteq\mathbb R^n\) è il vettore aleatorio\footnotemark{} che descrive i suoi \(n\in\mathbb N_+\) stati microscopici al tempo \(t\); allora le \cref{ipGasPerfetto,ipCaoMolecolare} si possono cosí riformulare:%
                \footnotetext{Si noti che il dominio \(I\) degli stati non coincide necessariamente coll'intero spazio reale \(\mathbb R^n\).}%

                \begin{ipo}
                    \label{ipTipoBolztmann}
                    Gli agenti sono caratterizzati dalle seguent'ipotesi:

                    \begin{enumerate}[
                        label=B\arabic*,
                        % topsep=0.5em,
                        % parsep=0em,
                        % itemsep=0.25em,
                        % leftmargin=2.5em,
                        % rightmargin=1.5em,
                        % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                        %itemindent=!,
                        %labelindent=3em,
                        %labelwidth=!,
                        %labelsep=!,
                    ]
                        \item\label{ipTipoBoltzmannDensitàOmogenea} la distribuzione statistica dei microstati è uniforme nello spazio, e quindi non dipende da esso;
                        \item\label{ipTipoBoltzmannInterazioniBinarie} gli agenti interagiscono solo binariamente, ovvero le interazioni a coppia sono le piú frequenti;
                        \item\label{ipTipoBoltzmannAgentiIndistinguibili} gli agenti sono indistinguibili cosicché ognuno è rappresentativo del loro insieme;
                        \item\label{ipTipoBoltzmannCaoMolecolare} due agenti interagenti sono statisticamente indipendenti.
                    \end{enumerate}
                    %
                    % Le prime tre sono riformulazioni dell'\cref{ipGasPerfetto} mentre l'ultima viene dall'\cref{ipCaoMolecolare}.
                \end{ipo}

                D'altra parte gli stati poscollisionali (postati), \(\mathbf X'_t\) e \(\mathbf X^{*\prime}_t\), si legano con quelli precollisionali (prestati), \(\mathbf X_t\) e \(\mathbf X^*_t\), tramite
                %
                \eqtag*{\([\text{RI}]_{\mathbf X}\)}{
                    \label{eqRegoleInterazione}
                    [\text{RI}]_{\mathbf X}
                    \left\{\begin{aligned}
                        \mathbf X'_t&=\psi(\mathbf X_t,\mathbf X_t^*,\mathbf y),\\
                        \mathbf X^{*\prime}_t&=\psi_*(\mathbf X_t,\mathbf X_t^*,\mathbf y_*),
                    \end{aligned}\right.
                }%
                ove ora
                \[
                    \begin{aligned}
                        \psi&\colon\mathbb R^n\times\mathbb R^n\times\mathbb R^h\to\mathbb R^n\\
                        \psi_*&\colon\mathbb R^n\times\mathbb R^n\times\mathbb R^{h_*}\to\mathbb R^n
                    \end{aligned}
                \]
                sono generiche regole d'interazione, non necessariamente lineari o simmetriche (\cref{defLeggiInterazioneSimmetriche}), mentre \(\mathbf y\in\mathbb R^h\) e \(\mathbf y_*\in\mathbb R^{h_*}\), con \(h,h_*\in\mathbb N\), rappresentano dei coefficienti potenzialmente stocastici.

                L'interazione tra di essi avviene secondo una variabile aleatoria di Bernoulli del tipo
                %
                \eqtag{\([\text{Ber}]_{\mathbf X}\)}{
                    \label{eqBernoulliInterazione}
                    \Theta\sim\DstrBernoulli(\mu(\mathbf X_t,\mathbf X^*_t,\mathbf w,t)\Delta t),
                }%
                con  tasso/nucleo d'interazione 
                %
                \eqtag{\([\text{NI}]_{\mathbf X}\)}{
                    \label{eqNucleoInterazione}
                    \mu(\mathbf X_t,\mathbf X^*_t,\mathbf w,t)\colon\mathbb R^n\times\mathbb R^n\times\mathbb R^k\times[0,+\infty)\to\RPlus,
                }%
                per controllare quant'è "probabile" che i due agenti interagiscano, e coefficienti \(\mathbf w\in\mathbf R^k\), con \(k\in\mathbb N\), potenzialmente stocastici.%
                \begin{oss}
                    Se non si sa o non si vuole toccare quell'aspetto modellistico si può semplicemente porre unitario:
                    \[
                        \mu\equiv1,\quad\forall(\mathbf x,\mathbf x_*,\mathbf w,t)
                        \in\mathbb R^n\times\mathbb R^n\times\mathbb R^k\times[0,+\infty)
                    \]
                    sottintendendo in tal modo un'uniforme "probabilità" d'interazione.
                \end{oss}
                
                Nel complesso i due agenti s'interfacciano mediante l'algoritmo d'interazione
                %
                \eqtag*{\([\text{AR}]_{\mathbf X}\)}{
                    \label{eqAlgoritmoInterazione}
                    [\text{AR}]_{\mathbf X}
                    \left\{\begin{aligned}
                        \mathbf X_{t+\Delta t}  &=(1-\Theta)\mathbf X_t+\Theta\mathbf X'_t,\\
                        \mathbf X^*_{t+\Delta t}&=(1-\Theta)\mathbf X^*_t+\Theta\mathbf X^{*\prime}_t,
                    \end{aligned}\right.
                }%
                dove \(\Delta t\in\RPlus\) è il passo temporale atto a discretizzare il tempo.

                \begin{oss}
                    \label{ossAlgoritmoAzioneReazione}
                    l'acronimo \ref{eqAlgoritmoInterazione} sta per «Azione-Reazione» poiché si suppone che ogn'interazione (azione), ossia \(\Theta=1\), necessariamente modifica entrambi gli stati degli agenti coinvolti (reazione); in alcuni contesti \cite{Nurisso2024} questa regola può essere alterata dimodoché solo l'agente interagente sia modificato portando alle interazioni «Azione-Azione».
                \end{oss}

                Infine, riapplicando un ragionamento analogo a quello svolto nel \cref{secBoltzmannOmogeno} colla quantità osservabile \(\varphi\colon\mathbb R^n\to\mathbb R\), si perviene all'equazione di tipo Boltzmann omogenea generale
                %
                \eqtag{\([\text{EtB}]_{\mathbf X}\)}{
                    \label{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico}
                    \derS{}t\int_{\mathbb R^n}\varphi f\de\mathbf x=
                    \int_{\mathbb R^{2n}}\left\langle
                        \mu(\mathbf x,\mathbf x_*,w,t)
                            \frac{\varphi'+\varphi'_*-\varphi-\varphi_*}2
                        \right\rangle
                    ff_*\de\mathbf x\de\mathbf x_*,
                }%
                nella quale \(\langle\cdot\rangle\) rappresenta la media rispetto a tutt'i coefficienti potenzialmente stocastici (\(\mathbf y\), \(\mathbf y_*\) e \(\mathbf w\)), mentre il termine \(-\varphi-\varphi_*\) discende dal fatto che non si è ipotizzato che il tasso d'interazione \(\mu\) sia pari.
                
                \begin{oss}[\ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico} simmetrica]
                    Qualora \ref{eqNucleoInterazione} sia pari (\cref{defNucleoInterazionePari}) e le regole d'interazione \ref{eqRegoleInterazione} siano simmetriche (\cref{defLeggiInterazioneSimmetriche}), la \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico} si può riformulare come
                    %
                    \begin{equation}
                        \label{eqFormaDeboleTipoBoltzmannOmogeneoSimmetrico}
                        \derS{}t\int_{\mathbb R^n}\varphi f\de\mathbf x=
                        \int_{\mathbb R^{2n}}\left\langle
                                \mu(\mathbf x,\mathbf x_*,w,t)(\varphi'-\varphi)
                            \right\rangle
                        ff_*\de\mathbf x\de\mathbf x_*,
                    \end{equation}
                    %
                    mediante un cambio di variabili atto a invertire \(\mathbf x\) e \(\mathbf x_*\) solo per la differenza \(\varphi'_*-\varphi_*\).
                \end{oss}

                \begin{dfn}[\ref{eqNucleoInterazione} pari]
                    \label{defNucleoInterazionePari}
                    Se il tasso d'interazione in \ref{eqNucleoInterazione} verifica
                    \[
                        \mu(\mathbf x,\mathbf x^*,\mathbf w,t)=\mu(\mathbf x^*,\mathbf x,\mathbf w,t)
                        \quad\forall\mathbf x,\mathbf x^*\in I\subseteq\mathbb R^n
                        \text{ e }\forall\mathbf w\in\mathbb R^k,
                    \]
                    allora \(\mu\) si dice pari.
                \end{dfn}

                \begin{dfn}[\ref{eqRegoleInterazione} simmetriche]
                    \label{defLeggiInterazioneSimmetriche}
                    Se le regole d'interazione del tipo \ref{eqRegoleInterazioneGas} verificano
                    \[
                        \begin{aligned}
                            \psi(\mathbf x,\mathbf x^*,\mathbf y)&=\psi_*(\mathbf x^*,\mathbf x,\mathbf y)\\
                            \psi_*(\mathbf x,\mathbf x^*,\mathbf y_*)&=\psi(\mathbf x^*,\mathbf x,\mathbf y_*)
                        \end{aligned}
                        \quad\forall\mathbf x,\mathbf x_*\in I\subseteq\mathbb R^n
                        \text{ e }\forall\mathbf y,\mathbf y_*\in\mathbb R^h,
                    \]
                    allora si dicono simmetriche. In altre parole, la simmetria implica
                    \[
                        \mathbf X'_t=\psi_*(\mathbf X^*_t,\mathbf X_t,\mathbf y)
                        \quad\text{e}\quad
                        \mathbf X^{*\prime}_t=\psi(\mathbf X^*_t,\mathbf X_t,\mathbf y_*).
                    \]
                \end{dfn}


            \subsubsection{Notazione}

                Nei previ paragrafi si è fatto spesso uso, specie per le varie equazioni [di tipo] Boltzmann \cref{eqFormaDeboleBoltzmannOmogeneoAssimmetricoGas,eqFormaForteBoltzmannDisomogeneoSimmetrico,eqFormaForteBoltzmannOmogeneoSimmetrico}, \ref{eqFormaDeboleBoltzmannOmogeneoSimmetrico} e \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico}, di una notazione abbreviata per tutti gli oggetti salvo il tasso d'interazione \(\mu\). In questo breve paragrafo si definiscono in maniera piú esplicita queste abbreviazioni facendo riferimento al contesto generale sviluppato poco fa.
                
                Innanzitutto la densità congiunta \(f\) da sola sottintende la variabile dell'agente interagente \(\mathbf x\) mentre con un pedice \(f_*\) quella dell'agente ricevente \(\mathbf x_*\):
                %
                \newcommand\valtmp{2em}
                \begin{equation*}
                    \newcommand\hspc{\hspace{\valtmp}}
                    f\equiv f(\mathbf x,t)
                    \hspc\text{e}\hspc
                    f_*\equiv f(\mathbf x_*,t);
                \end{equation*}
                %
                dopodiché le quantità osservabili \(\varphi\) seguono la medesima logica di prima ma coll'aggiunta di un apice per distinguere le variabili postinterazionali:
                %
                \begin{equation*}
                    \newcommand\hspc{\hspace{\valtmp}}
                    \begin{aligned}
                        \varphi&\equiv\varphi(\mathbf x)\\
                        \varphi'&\equiv\varphi(\mathbf x')
                    \end{aligned}
                    \hspc
                    \begin{aligned}
                        &\text{e}\\
                        &\text{e}
                    \end{aligned}
                    \hspc
                    \begin{aligned}
                        \varphi_*&\equiv\varphi(\mathbf x_*),\\
                        \varphi_*'&\equiv\varphi(\mathbf x'_*).
                    \end{aligned}
                \end{equation*}
                %
                Ovviamente questa notazione può essere generalizzata a una qualunque funzione scalare \(g\colon\mathbb R^n\to\mathbb R\) funzione del microstato degli agenti:
                %
                \begin{equation*}
                    \newcommand\hspc{\hspace{\valtmp}}
                    \begin{aligned}
                        g&\equiv g(\mathbf x)\\
                        g'&\equiv g(\mathbf x')
                    \end{aligned}
                    \hspc
                    \begin{aligned}
                        &\text{e}\\
                        &\text{e}
                    \end{aligned}
                    \hspc
                    \begin{aligned}
                        g_*&\equiv g(\mathbf x_*),\\
                        g_*'&\equiv g(\mathbf x'_*).
                    \end{aligned}
                \end{equation*}
                %
                Infine si osserva che qualora vi siano altri pedici o apici nelle funzioni a venire, essi \textit{non} fanno riferimento a questa notazione corta, se non altrimenti specificato. Per esempio giusto nel prossimo paragrafo si lavora con delle densità \(f_i\), in cui \(i\) è l'indice del nodo del grafo associato all'agente; è comunque possibile, anche per questi casi, usare la notazione precedente riposizionando lievemente i pedici e gli apici:
                %
                \begin{equation*}
                    \newcommand\hspc{\hspace{\valtmp}}
                    f^i\equiv f(\mathbf x,t)
                    \hspc\text{e}\hspc
                    f_i^*\equiv f(\mathbf x_*,t);
                \end{equation*}

            \subsubsection{Analisi dimensionale}

                Finora tutte le equazioni passate fanno riferimento a un tempo adimensionale, sebbene l'introduzione di un tempo sia una modifica alquanto indolore e che lasci trasparire un'interessante interpretazione del passo temporale \(\Delta t\).
                
                Sia dunque \(\tilde t=\tau t\) il tempo dimensionale scomposto nel prodotto di in uno adimensionale \(t\) e della dimensione \(\tau\).

                \begin{oss}
                    Seguendo la notazione ISO \cite[§ 6.2]{ISO80k3} \(\tilde t\) dev'essere scritto \(\tilde t=\{t\}\times[t]\) ma, per leggerezza di notazione, si omettono le parentesi ponendo \(\tau\equiv[t]\): l'importante è vedere \(t\) come il valore numerico variabile e adimensionale, mentre \(\tau\) come la dimensione costante e fissa.
                \end{oss}

                Detto ciò, mediante la derivata dimensionale
                %
                \begin{equation*}
                    \derS\cdot t=\tau\derS\cdot{\tilde t}
                \end{equation*}
                %
                e le riformulazioni
                %
                \begin{equation*}
                    \tilde f(\mathbf x,\tilde t)\equiv f(\mathbf x,\tilde t/\tau),
                    \quad\text{ e }\quad
                    \tilde f_*(\mathbf x_*,\tilde t)\equiv f(\mathbf x_*,\tilde t/\tau),
                \end{equation*}
                %
                abbreviate con \(\tilde f\) e \(\tilde f_*\) rispettivamente, la \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico} diventa
                %
                \begin{equation}
                    \label{eqTipoBoltzmannSemiDimensionale}
                    \derS{}{\tilde t}\int_{\mathbb R^n}\varphi\tilde f\de\mathbf x=
                    \frac1\tau\int_{\mathbb R^{2n}}\left\langle
                        \mu(\mathbf x,\mathbf x_*,w,\tilde t/\tau)
                            \frac{\varphi'+\varphi'_*-\varphi-\varphi_*}2
                        \right\rangle
                    \tilde f\tilde f_*\de\mathbf x\de\mathbf x_*.
                \end{equation}
                %
                Per capire come varia il tasso d'interazione \(\mu\) è sufficinete dimensionalizzare la \ref{eqBernoulliInterazione}:
                %
                \begin{equation*}
                    \Theta\sim\DstrBernoulli\left(
                        \mu(\mathbf X_t,\mathbf X^*_t,\mathbf w,\tilde t/\tau)\frac{\Delta\tilde t}\tau,
                    \right),
                \end{equation*}
                %
                da cui si deduce il tasso d'interazione dimensionale \(\tilde\mu\):
                %
                \begin{equation*}
                    \tilde\mu(\mathbf x,\mathbf x_*,w,\tilde t)
                    \equiv\frac1\tau\mu(\mathbf x,\mathbf x_*,w,\tilde t/\tau),
                \end{equation*}
                %
                che trasforma la \cref{eqTipoBoltzmannSemiDimensionale} nell'equazione di tipo Boltzmann dimensionale
                %
                \begin{equation}
                    \label{eqTipoBoltzmannDimensionale}
                    \derS{}{\tilde t}\int_{\mathbb R^n}\varphi\tilde f\de\mathbf x=
                    \int_{\mathbb R^{2n}}\left\langle
                        \tilde\mu(\mathbf x,\mathbf x_*,w,\tilde t)
                            \frac{\varphi'+\varphi'_*-\varphi-\varphi_*}2
                        \right\rangle
                    \tilde f\tilde f_*\de\mathbf x\de\mathbf x_*.
                \end{equation}

                \begin{oss}[frequenza d'interazione]
                    Dall'identità \(\Delta\tilde t=\tau\Delta t\) si può interpretare \(\Delta t\) come la frazione della dimensione \(\tau\) dopo la quale può avvenire un'interazione, da cui si deduce che \(\Delta\tilde t\) è l'intervallo di tempo tra due interazioni.
                   
                    Di conseguenza si può vedendo l'\ref{eqAlgoritmoInterazione} come un fenomeno periodico di periodo \(\Delta\tilde t\) e frequenza
                    %
                    \begin{equation*}
                        \tilde f\equiv\frac1{\Delta\tilde t}=\frac1{\tau\Delta t}\equiv\frac1\tau f,
                    \end{equation*}
                    %
                    in cui, come prima \(1/\tau\) è la dimensione della frequenza adimensionale \(f\).

                    Ecco che il reciproco del passo temporale \(\Delta t\) prende il significato della frequenza d'interazione del fenomeno, nell'unità di tempo sia adimensionale che dimensionale mediante \(1/\tau\).
                \end{oss}

                \begin{oss}[Scelta di \(\tau\)]
                    La precedente osservazione permette anche di esplicitare un metodo con cui decidere la dimensione temporale \(\tau\): si consideri \(\Delta t=0.01\), allora la frequenza è di \(100\) interazioni nell'unità di tempo. In un fenomeno come quello urbano si possono allora escludere due scale:

                    \begin{itemize}[
                        label=\(\diamond\),
                        % topsep=0.5em,
                        % parsep=0em,
                        itemsep=0.1em,
                        % leftmargin=2em,
                        % rightmargin=1.5em,
                        % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                        %itemindent=!,
                        % labelindent=30pt,
                        %labelwidth=!,
                        %labelsep=!,
                    ]
                        \item quella dei mesi o superiori, perché è irrealistico che in un arco temporale cosí lungo vi siano solo 100 interazioni tra le città;
                        \item similmente quella dei secondi o inferiori per un ragionamento simile a quello di prima ma opposto.
                    \end{itemize}

                    È pertanto naturale che la scala ideale in tal contesto sia quella dei giorni.
                \end{oss}

                Cionnonostante, in questo scritto non si studia un'equazione di tipo Boltzmann dimensionale analoga alla \cref{eqTipoBoltzmannDimensionale} per tre principali motivazioni:

                \begin{enumerate}[
                    label=\arabic*.,
                    % topsep=0.5em,
                    % parsep=0em,
                    itemsep=0.1em,
                    % leftmargin=2em,
                    % rightmargin=1.5em,
                    % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                    %itemindent=!,
                    %labelindent=3em,
                    %labelwidth=!,
                    %labelsep=!,
                ]
                    \item la dimensione va considerata solo se si è interessati a studiare il transitorio, non la distribuzione stazionaria;
                    \item lo studio di quest'ultimo è incompatibile coll'\cref{ipGrafoStatico} di grafo statico; 
                    \item mancano i dati storici, sia attendibili che su scale temporali adeguate, per poter confrontare il transitorio simulato con quello reale.
                \end{enumerate}

                Tali sono le ragioni per cui il tempo sarà sempre considerato adimensionale da qui in poi: l'obbiettivo è studiare la distribuzione stazionaria raggiunta, non in quanto tempo si raggiunge (tempo di convergenza).

    \section{Descrizione cinetica urbana su reti}\label{secDescrizioneCineticaUrbana} %  d'interazioni mediante da un grafo
    
        Si analizza adesso il caso del tessuto interurbano descritto nel \cref{secRetiECittà}, considerando le città sia come agenti che come nodi di una rete che ne regola le interazioni: due città possono interagire sse sono connessi; è anche ovvio che l'interazione modifichi, in qualche modo da definire, la loro popolazione.

        In questo paragrafo si applicano i concetti della teoria sviluppata nei \cref{secDefinizioniGrafi,secTipoBoltzmannOmogeno} e, in particolare, la notazione usata e definita. S'inizia mostrando una derivazione esatta la quale, cioè, considera la topologia esatta; quindi si approfondisce un'approssimazione nella quale si "perde" la topologia indotta dalla rete; infine, si considerano i collegamenti tra la derivazione esatta e qualla di tipo Boltzmann sotto determinate ipotesi.

        \subsection{Equazione di tipo Boltzmann esatta}\label{secTipoBoltzmannUrbano}
            
            \subsubsection{Descrizione e derivazione}

                Visto che si assume che valgono le \cref{ipTipoBolztmann}\footnotemark{}, dalla \ref{ipTipoBoltzmannAgentiIndistinguibili} sorge un problema non di poco conto: gli agenti sono indistinguibili ma la rete sottostante li rende distinti per via degl'indici \(\mathcal I\).%
                \footnotetext{Perdipiú la \ref{ipTipoBoltzmannInterazioniBinarie} è valida \textit{a un tempo} \(t\), ma nell'unità di tempo \textit{dimensionale} \(\tilde t\) le interazioni si possono considerate come non binarie, come già discusso alla fine del \cref{secTipoBoltzmannOmogeno}.}%

                Per dipanare la questione è sufficiente considerare l'indice come una variabile aleatoria \(I\in\mathcal I\) cosí da definire il processo stocastico come
                %
                \begin{equation*}
                    % \label{eqProcessoStocasticoUrbano}
                    \{\mathbf X_t\}\equiv\{I,S_t\}_{t\in\RPlus},
                \end{equation*}
                %
                in cui \(S_t\in\RPlus\) è la variabile aleatoria relativa alla popolazione dell'agente rappresentativo al tempo \(t\) ed è l'unica componente del processo stocastico a variare nel tempo per l'\cref{ipGrafoStatico}.

                \begin{oss}[Sulla natura numerica della popolazione]
                    \label{ossNaturaNumericaPopolazione}
                    È naturale che non esistano frazioni di persone e che quindi rigorosamente \(S_t\in\mathbb N\) ma non sempre la scelta piú realistica è quella che modellisticamente è piú agevole; infatti trattare \(S_t\) come una variabile aleatoria discreta impone un codominio, appunto, discreto che è in genere piú difficile da manipolare matematicamente rispetto a un intervallo continuo. Tal'è la ragione nel scegliere \(S_t\) reale: dopo aver fatto i conti normalmente si può poi approssimare per eccesso o difetto ricavando la taglia intera effettiva; l'errore cosí commesso è di al piú una persona.
                \end{oss}

                Cosí ragionando si può nel complesso descrivere statisticamente lo stato microscopico \(\mathbf X_t\equiv(I,S_t)\) dell'agente rappresentativo colla densità congiunta
                %
                \begin{equation*}
                    f(i,s,t)\colon\mathcal I\times\RPlus\times[0,+\infty)\to\RPlus,
                \end{equation*}
                %
                che è discreta in \(i\in\mathcal I\) e continua in \(s\in\RPlus\), uguale a
                %
                \begin{equation}
                    \label{eqDensitàCongiuntaUrbana}
                    f(i,s,t)\equiv\frac1N\sum_{j\in\mathcal I}f_j(s,t)\otimes\delta(i-j),
                \end{equation}
                %
                dove \(N\equiv\vert\mathcal I\vert\) è il numero totale d'agenti del grafo mentre \(\delta(\cdot)\) denota la delta di Dirac centrata all'origine; d'altra parte
                %
                \begin{equation*}
                    f_i=f_i(s,t):\RPlus\times[0,+\infty)\rightarrow\RPlus
                \end{equation*}
                %
                è la densità di \(S_t\) dell'agente \(i\)-esimo.

                In tal modo la densità congiunta \(f\) è effettivamente indistinguibile rispetto a tutti gli agenti, soddisfacendo la \ref{ipTipoBoltzmannAgentiIndistinguibili}, e integra sul suo dominio a uno:
                %
                \begin{equation*}
                    \begin{aligned}
                        \mathbb P_t(\mathcal I\times\RPlus)
                        &=\int_{\mathcal I}\int_{\RPlus}f(i,s,t)\de s\de i
                        =\frac1N\sum_{i\in\mathcal I}\int_{\mathcal I}\int_{\RPlus}
                        f_i(s,t)\de s\otimes\delta(i-j)\de i
                        \\&=\frac1N\sum_{i\in\mathcal I}\int_{\mathcal I}\delta(i-j)\de i
                        =\frac1N\sum_{i\in\mathcal I}1=\frac NN=1,
                        \quad\forall t\geq0;
                    \end{aligned}
                \end{equation*}
                %
                mentre le densità \(f_i\) preservano la naturale distinguibilità degli agenti indotta dalla topologia sottostante.

                Sempre come conseguenza del grafo, la \ref{eqBernoulliInterazione} deve dipendere dalla matrice d'adiacenza \(\mathbf A\):
                %
                \eqtag{\([\text{Ber}]^{\mathbf A}_S\)}{
                    \label{eqBernoulliInterazioneUrbana}
                    \Theta\sim\DstrBernoulli(A(I,I^*)\Delta t),
                }%
                ove \(A\colon\mathcal I\times\mathcal I\to\mathbb R\) è una funzione che a ogni coppia d'indici \((I,I^*)\) associa la relativa entrata nella matrice d'adiacenza
                %
                \begin{equation*}
                    \newcommand\hspz{\hspace{1em}}
                    A(I,I^*)\equiv a_{I,I^*}=
                    \left\{\begin{aligned}
                        1&\hspz\text{se }(I,I^*)\in\mathcal E,\\
                        0&\hspz\text{ altrimenti},%(I,I^*)\notin\mathcal E,
                    \end{aligned}\right.
                \end{equation*}
                %
                secondo la \cref{eqMatriceAdiacenzaUnitaria}; in tal modo l'interazione non ha possibilità d'avvenire se i due agenti non sono connessi.

                \begin{oss}
                    \label{ossConfrontoBernoulliClassicoUrbano}
                    Rispetto al caso generale \ref{eqBernoulliInterazione} il tasso d'interazione ha forma
                    %
                    \begin{equation}
                        \label{eqTassoInterazioneUrbano}
                        % \mu(\mathbf X_t,\mathbf X^*_t,\mathbf w,t)\equiv A(I,I^*),
                        \mu(i,i_*)\equiv A(i,i_*),
                    \end{equation}
                    %
                    esso, cioè, è per definizione costante sia rispetto agli stati \(S_t\) e \(S^*_t\) che rispetto al tempo, oltre a non avere coefficienti\footnotemark{} \(\mathbf w\).%
                    \footnotetext{Questa situazione si può simbolicamente rappresentare ponendo \(k=0\).}%
                \end{oss}

                \begin{oss}
                    Per definizione della distribuzione di Bernoulli, è necessario imporre \(A(I,I^*)\Delta t\leq1\), ma dato che \(A(I,I^*)\in\{0,1\}\) ciò si traduce nella naturale condizione che \(\Delta t\leq1\).
                \end{oss}

                D'altro canto le regole d'interazione nella \ref{eqRegoleInterazione} diventano
                %
                \eqtag*{\([\text{RI}]_S\)}{
                    \label{eqRegoleInterazioneUrbane}
                    [\text{RI}]_S
                    \left\{\begin{aligned}
                        S'_t&=\psi(S_t,I,S^*_t,I_*,\gamma),\\
                        S^{*\prime}_t&=\psi_*(S_t,I,S^*_t,I_*).
                    \end{aligned}\right.
                }%
                \begin{oss}
                    Confrontato a \ref{eqRegoleInterazione}, solo la funzione della città interagente \(\psi\) presenta un coefficiente stocastico \(y\equiv\gamma\in\mathbb R\), mentre quella relativa alla città ricevente \(\psi_*\) non dipende da potenziali coefficienti\footnotemark{} \(\mathbf y_*\).%
                    \footnotetext{Come nell'\cref{ossConfrontoBernoulliClassicoUrbano}, tale condizione si può simbolicamente rappresentare ponendo \(h_*=0\).}%
                \end{oss}

                Unendo le \ref{eqBernoulliInterazioneUrbana} e \ref{eqRegoleInterazioneUrbane}, le \ref{eqAlgoritmoInterazione} si scrivono
                %
                \eqtag*{\([\text{AR}]_S\)}{
                    \label{eqAlgoritmoInterazioneUrbano}
                    [\text{AR}]_S\left\{
                    \begin{aligned}
                        S_{t+\Delta t}&=(1-\Theta)S_t+\Theta S'_t,\\
                        S^*_{t+\Delta t}&=(1-\Theta)S^*_t+\Theta S^{*\prime}_t,
                    \end{aligned}\right.
                }%
                coerentemente col fatto che in un cotesto urbano, qualora una città-nodo interagisca con un'altra, entrambe debbano variare il loro stato (\cref{ossAlgoritmoAzioneReazione}).

                \begin{oss}
                    Paragonato a \ref{eqAlgoritmoInterazione} ci si potrebbe chiedere perché non si considera l'intero vettore aleatorio \(\mathbf X_t\), come pure nella \ref{eqRegoleInterazioneUrbane}; la ragione è che \(I\) è una componente statica che non varia nel tempo.
                
                    In ogni caso, considerando \(I_t\) e \(I^*_t\) momentaneamente dinamiche, si possono definire le regole d'interazione
                    \[
                        [\text{RI}]_I\left\{
                        \begin{aligned}
                            I'_t&=\psi(S_t,I,S^*_t,I_*)\equiv I_t,\\
                            I^{*\prime}_t&=\psi_*(S_t,I,S^*_t,I_*)\equiv I_t^*,
                        \end{aligned}\right.
                    \]
                    da cui segue l'algoritmo d'interazione
                    \[
                        [\text{AR}]_I\left\{
                        \begin{aligned}
                            I_{t+\Delta t}&=(1-\Theta)I_t+\Theta I'_t=(1-\Theta)I_t+\Theta I_t=I_t,\\
                            I^*_{t+\Delta t}&=(1-\Theta)I^*_t+\Theta I^{*\prime}_t=(1-\Theta)I^*_t+\Theta I^*_t=I^*_t,
                        \end{aligned}\right.
                    \]
                    che soddisfa la staticità di \(I\) e \(I_*\) e completa, assieme a \ref{eqAlgoritmoInterazioneUrbano}, la formulazione \ref{eqAlgoritmoInterazione} piú generale.
                \end{oss}

                Sia \(\Phi\colon\mathcal I\times\RPlus\to\mathbb R\) un'arbitraria quantità osservabile, dalla \ref{eqBernoulliInterazioneUrbana} l'equazione di tipo Boltzmann omogenea \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico} ha forma
                %
                \eqtag{\([\text{EtB}]^{\mathbf A}_S\)}{
                    \label{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbano}
                    \derS{}t\int_{\mathcal I}\int_{\RPlus}
                    \Phi f\de v \de i=
                    \int_{\mathcal I^2}\int_{\RPlus^2}A(i,i_*)
                    \frac{\langle \Phi'+\Phi_*'-\Phi-\Phi_*\rangle}2
                    ff_*\de s\de s_*\de i\de i_*,
                }%
                ove si è usata la notazione abbreviata illustrata nel \cref{secTipoBoltzmannOmogeno}, mentre \(\langle\cdot\rangle\) indica il valore atteso rispetto alla variabile aleatoria \(\gamma\) nelle \ref{eqRegoleInterazioneUrbane}.

                \begin{oss}
                    Anche se la derivazione della \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbano} è già stata spiegata nel dettaglio nel \cref{secBoltzmannOmogeno}, rimane interessante riportare la forma del passaggio piú difficile, ossia quella della media condizionata \cref{eqMediaCondizionataGas} (qui mostrato solo per \(S_{t+\Delta t}\)):
                    %
                    \begin{equation*}
                        %\label{}
                        \begin{aligned}
                            \mathbb E[\Phi(I,S_{t+\Delta t})]=
                            \mathbb E\left[\mathbb E\right.[
                                &\Phi\left(I,(1-\Theta)S_t
                                +\Theta\psi(S_t,I,S_t^*,I_*,\sigma)
                                A(I,I_*)\Delta t\right)|I,I_*
                            ]\left.\vphantom{\mathbb E}\right]\\
                            =\mathbb E\left[
                                \mathbb E\right.[
                                &\Phi(I,S_t)(1-A(I,I_*)\Delta t)
                                \\&+\Phi\left(
                                    I,\psi(S_t,I,S_t^*,I_*,\sigma)
                                \right)A(I,I_*)\Delta t
                            ]\left.\vphantom{\mathbb E}\right].
                        \end{aligned}
                    \end{equation*}
                    %
                    Si noti come il condizionamento sia solo rispetto a \(I\) a \(I_*\), proprio poiché \(\Theta\) in \ref{eqBernoulliInterazioneUrbana}, tramite il tasso d'interazione \(\mu\) nella \cref{eqTassoInterazioneUrbano}, dipende solo da essi.
                \end{oss}
            
                %\begingroup
                    % Allora dalla prima equazione in \ref{eqAlgoritmoInterazione}, valutando il valore atteso dell'osservabile postinterazione rispetto agl'indici e alla popolazione a tempo fissato, si ha \daRivedere
                    % %
                    % \begin{equation*}
                    %     %\label{}
                    %     \begin{aligned}
                    %         \mathbb E[\Phi(X,S_{t+\Delta t})]=
                    %         \mathbb E\left[\mathbb E\right.[
                    %             &\Phi\left(X,(1-\Theta)S_t
                    %             +\Theta\Psi(S_t,S_t^*,\omega)
                    %             A(X,X_*)\Delta t\right)|X,X_*
                    %         ]\left.\vphantom{\mathbb E}\right]\\
                    %         =\mathbb E\left[
                    %             \mathbb E\right.[
                    %             &\Phi(X,S_t)(1-A(X,X_*)\Delta t)
                    %             \\&+\Phi\left(
                    %                 X,\Psi(S_t,S_t^*,\omega)
                    %             \right)A(X,X_*)\Delta t
                    %         ]\left.\vphantom{\mathbb E}\right],
                    %     \end{aligned}
                    % \end{equation*}
                    % %
                    % da cui, riordinando i termini e dividendo ambo i membri per \(\Delta t\), si deduce
                    % %
                    % \begin{equation*}
                    %     %\label{}
                    %     \frac{
                    %         \mathbb E[\Phi(X,S_{t+\Delta t})
                    %         -\mathbb E[\Phi(X,S_t)]]
                    %     }{\Delta t}=
                    %     \mathbb E\left[
                    %         A(X,X_*)\left(
                    %             \Phi(X,\Psi(S_t,S_t^*,\omega))-\Phi(X,S_t)
                    %         \right)
                    %     \right],
                    % \end{equation*}
                    % %
                    % laddove, prendendo il limite \(\Delta t\to0^+\), si ricava formalmente
                    % %
                    % \begin{equation}
                    %     \label{eqDinamicaValoreAtteso1}
                    %     \derS{\mathbb E[\Phi(X,S_t)]}t=
                    %     \mathbb E\left[
                    %         A(X,X^*)\left(
                    %             \Phi(X,\Psi(S_t,S_t^*,\omega))-\Phi(X,S_t)
                    %         \right)
                    %     \right].
                    % \end{equation}
                    % %
                    % Si può ricavare una simile equazione ripetendo i precedenti passaggi ma colla seconda equazione di \ref{eqAlgoritmoInterazione}, da cui
                    % %
                    % \begin{equation}
                    %     \label{eqDinamicaValoreAtteso2}
                    %     \derS{\mathbb E[\Phi(X^*,S^*_t)]}t=
                    %     \mathbb E\left[
                    %         A(X,X^*)\left(
                    %             \Phi(X^*,\Psi_*(S^*_t,S_t,\omega))-\Phi(X^*,S^*_t)
                    %         \right)
                    %     \right].
                    % \end{equation}
                    % %
                    % Osservando che le coppie \((X,S_t)\) e \((X^*,S_t^*)\) fanno riferimento a un agente rappresentativo generico del sistema, vale \[\mathbb E[\Phi(X,S_t)]=\mathbb E[\Phi(X^*,S^*_t)]\] cosicché, sommando \cref{eqDinamicaValoreAtteso1,eqDinamicaValoreAtteso2}, si ha
                    % %
                    % \begin{equation*}
                    %     %\label{}
                    %     \begin{aligned}
                    %         \derS{\mathbb E[\Phi(X,S_t)]}t=
                    %         \frac12\mathbb E\bigl[
                    %             A(X,X^*)\bigl(
                    %                 &\Phi(X,\Psi(S_t,S^*_t,\omega))
                    %                 +\Phi(X^*,\Psi_*(S^*_t,S_t,\omega))
                    %                 \\&
                    %                 -\Phi(X,S_t)-\Phi(X^*,S^*_t)
                    %             \bigr)
                    %         \bigr],
                    %     \end{aligned}
                    % \end{equation*}
                %\endgroup
            
            \subsubsection{Analisi delle regole d'interazione}

                Si approfondiscono in questo paragrafo le regole d'interazione \ref{eqRegoleInterazioneUrbane}.

                Innanzitutto, il perché nella \ref{eqAlgoritmoInterazioneUrbano} si considerano interazioni «Azione-Reazione» (\cref{ossAlgoritmoAzioneReazione}) discende da un vincolo fisico: se una città interagisce con un'altra, scambiando popolazione, necessariamente anche l'altra varia il proprio stato.

                Dopodiché, passando alle realizzazioni di tutte le variabili aleatorie considerate, vale a dire scrivendole in minuscolo e omettendo la dipendenza dal tempo, le regole d'interazione \ref{eqRegoleInterazioneUrbane} sono cosí definite\footnotemark{}%
                \footnotetext{Sono state in parte ispirate dalla \cite[(2.1) p. 223]{Gualandi2019SDC}.}%
                %
                \eqtag*{\([\text{RE}]\)}{
                    \label{eqRegoleInterazioneUrbaneEsplicite}
                    [\text{RE}]
                    \left\{\begin{aligned}
                        \psi(s,i,s_*,i_*\gamma)&=s\bigl(1-E(s,i,s_*,i_*)+\gamma\bigr)\\
                        \psi_*(s,i,s_*,i_*)&=s_*+sI(s,i,s_*,i_*)
                    \end{aligned}\right.
                }%
                ove
                %
                \begin{equation*}
                    \begin{aligned}
                        E\colon\RPlus\times\RPlus\times\mathcal I\times\mathcal I\to\RPlus,\\
                        I\colon\RPlus\times\RPlus\times\mathcal I\times\mathcal I\to\RPlus,
                    \end{aligned}
                \end{equation*}
                %
                sono rispettivamente i tassi d'emigrazione e immigrazione, i cui argomenti sono per brevità sottintesi da qui in poi, mentre \(\gamma\) rappresenta fluttuazioni stocastiche. Si caratterizza ulteriormente \(E\):

                \begin{ipo}
                    Per avere un postato \(s\) fisicamente sensato, ossia positivo, quando \(\gamma=0\), si assume che il tasso d'emigrazione \(E\) sia superiormente limitato dalla costante \(\lambda\equiv\sup E\), tale che \(\lambda\in(0,1)\), e inferiormente limitato dall'origine:
                    %
                    \begin{equation*}
                        0\leq E\leq\lambda<1,\ \ \forall s,\ \forall s_*,\ \forall i,\ \forall i_*.
                    \end{equation*}
                    %
                    D'altra parte il postato \(s_*'\) [per il momento] non si considera poiché è per definizione sempre positivo qualunque sia il tasso d'immigrazione \(I\in[0,+\infty)\).
                \end{ipo}
               
                Se invece \(\gamma\) è non nullo, dev'essere anch'esso limitato:
                %
                \begin{equation}
                    \label{eqVincoloPositivitàFluttuazioni}
                    s'=s(1-E+\gamma)>0
                    \ \ \implies\ \ 
                    \gamma>E-1,
                    \ \ \forall E\in[0,\lambda],
                \end{equation}
                %
                La scelta di \(>\) anziché \(\geq\) nella \eqref{eqVincoloPositivitàFluttuazioni} è ben fondata: di fatto si sta supponendo che le fluttuazioni non possono annullare la popolazione di una città\footnotemark{}.%
                \footnotetext{Ciò non significa che il modello non possa prevedere lo spopolamento di una città, poiché la sua taglia può arbitrariamente avvicinarsi a zero [ma mai esserne uguale], raggiungendolo solo \textit{a posteriori} dopo l'approssimazione dai numeri reali a quelli interi (\cref{ossNaturaNumericaPopolazione}).}%

                Perdipiú, le fluttuazioni rappresentano a grandi linee quei fenomeni complessivi di nascita e di morte che vengono considerati ma non direttamente modellati; pertanto valgono le seguenti ipotesi:

                \begin{ipo}
                    \label{ipFluttuazioni}
                    \(\gamma\) deve soddisfare le seguenti caratteristiche:

                    \begin{enumerate}[
                        label=F\arabic*,
                        % topsep=0.5em,
                        % parsep=0em,
                        % itemsep=0.25em,
                        % leftmargin=3em,
                        % rightmargin=1.5em,
                        % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                        %itemindent=!,
                        %labelindent=3em,
                        %labelwidth=!,
                        %labelsep=!,
                    ]
                        \item\label{ipFluttuazioniPositivitàNegatività} può assumere sia valori positivi che negativi, ma non minori del vincolo imposto da \eqref{eqVincoloPositivitàFluttuazioni};
                        \item\label{ipFluttuazioniMediaNulla} la media è scelta arbitrariamente posta allo zero, ossia \(\langle\gamma\rangle=0\);
                        \item\label{ipFluttuazioniProbabilitàDecrescente} seppure non vi siano limiti superiori per l'entità della fluttuazione, è chiaro che piú grande questa è meno è probabile.
                    \end{enumerate}
                \end{ipo}

                Con queste si possono allora analizzare alcune distribuzioni continue:

                \begin{enumerate}[
                    label=\arabic*.,
                    % topsep=0.5em,
                    % parsep=0em,
                    % itemsep=0.25em,
                    % leftmargin=2em,
                    % rightmargin=1.5em,
                    % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                    %itemindent=!,
                    %labelindent=3em,
                    %labelwidth=!,
                    %labelsep=!,
                ]
                    \item la distribuzione normale \(\mathcal N(\mu,\gamma)\) non soddisfà la \ref{ipFluttuazioniPositivitàNegatività} poiché può assumere valori reali arbitrari con probabilità non nulla;
                    \item la distribuzione uniforme \(\mathcal U([a,b])\) è adeguata solo per intervalli finiti e diventa degenere quando un suo estremo diverge, per cui non soddisfà né \ref{ipFluttuazioniMediaNulla} né \ref{ipFluttuazioniProbabilitàDecrescente}, mentre \ref{ipFluttuazioniPositivitàNegatività} sí;
                    \item la distribuzione esponenziale \(\DstrEsponenziale(\lambda)\) è quella piú promettente perché riflette sia \ref{ipFluttuazioniMediaNulla} (dopo un'opportuna traslazione dei valori campionati) che \ref{ipFluttuazioniProbabilitàDecrescente}, ma sfortunatamente non \ref{ipFluttuazioniPositivitàNegatività} perché la densità è non nulla al valore estremo \(\gamma=E-1\);
                    \item l'unica distribuzione che soddisfà tutt'e tre le caratteristiche ricercate è proprio la distribuzione \(\DstrGamma(\alpha,\beta)\).
                \end{enumerate}

                Si assuma allora \(\hat\gamma\sim\DstrGamma(\alpha,\beta)\) con densità
                %
                \begin{equation*}
                    % \label{eqDensitàDistribuzioneGamma}
                    f_\gamma(x)=\frac1{\beta^\alpha\Gamma(\alpha)}x^{\alpha-1}
                    \exp\left(-\frac x\beta\right),
                \end{equation*}
                %
                ove \(\alpha\) e \(\beta\) sono i parametri rispettivamente di forma e di scala, mentre
                %
                \begin{equation*}
                    \Gamma(\alpha)\colon\RPlus\to\RPlus
                \end{equation*}
                %
                è la funzione gamma
                %
                \begin{equation*}
                    \Gamma(\alpha)\equiv\int_0^{+\infty}y^{\alpha+1}e^{-y}\de y.
                \end{equation*}
                %
                Imponendo la \ref{ipFluttuazioniPositivitàNegatività} si ottiene
                %
                \begin{equation*}
                    % \label{eqMediaVarianzaFluttuazioni}
                    \langle\hat\gamma\rangle=1-E=\alpha\beta
                    \quad\text{e}\quad
                    \Varianza(\hat\gamma)\equiv\sigma^2=\alpha\beta^2,
                \end{equation*}
                %
                in cui \(\sigma^2\) indica la varianza, da cui
                %
                \begin{equation*}
                    % \label{eqParametriDstrGamma}
                    \alpha=\frac{(1-E)^2}{\sigma^2}
                    \quad\text{e}\quad
                    \beta=\frac{\sigma^2}{1-E}.
                \end{equation*}
                %
                La \ref{ipFluttuazioniMediaNulla} si può semplicemente soddisfare traslando i valori campionanti della \(\hat\gamma\) di \(-\langle\hat\gamma\rangle\), ossia si considera la distribuzione \(\gamma\sim\hat\gamma-\langle\hat\gamma\rangle\):
                %
                \begin{equation*}
                    \langle\gamma\rangle=
                    \langle\hat\gamma-\langle\hat\gamma\rangle\rangle=
                    \langle\hat\gamma\rangle-\langle\hat\gamma\rangle=0.
                \end{equation*}
                %
                D'altra parte per la \ref{ipFluttuazioniPositivitàNegatività} bisogna salvaguardarsi dai casi degeneri della distribuzione gamma: essa infatti se \(\alpha=1\) diventa \(\DstrEsponenziale(\beta)\), mentre se \(\alpha<1\) diverge all'origine; per avere quindi probabilità nulla di campionare da \(\hat\gamma\) l'origine [e quindi -\(\langle\hat\gamma\rangle\) dopo la traslazione] è necessario porre
                %
                \begin{equation}
                    \label{eqVincoloTraParametri}
                    \alpha>1
                    \ \ \implies\ \ 
                    \frac{(1-E)^2}{\sigma^2}\geq
                    \frac{(1-\lambda)^2}{\sigma^2}>1
                    \ \ \implies\ \ 
                    % \sigma^2<(1-\lambda)^2
                    % \ \ \implies\ \ 
                    \sigma<\vert1-\lambda\vert=1-\lambda.
                \end{equation}
                %
                La \eqref{eqVincoloTraParametri} implica quindi che non è possibile avere una varianza arbitraria per poter soddisfare la \ref{ipFluttuazioniPositivitàNegatività}, ma che questa è limitata superiormente dal massimo tasso d'emigrazione \(\lambda\), interpretabile come attrattività: piú grande è \(\lambda\) piú piccola è la varianza, e viceversa.

                In realtà la \(\sigma\) non può davvero assumere valori arbitrari tra \(0\) e \(1-\lambda\): difatti se \(\sigma\to1-\lambda\) vale \(\alpha\to1\) e dunque la distribuzione gamma tende a un'esponenziale; questo ha l'effetto d'introdurre una pericolosa asimmetria nella densità, come si può notare nella la \cref{figTransizioneAsimmetria}: una volta centrata rispetto alla media la moda (il valore piú frequente) ha valore negativo portando, in un orizzonte temporale finito, le perturbazioni negative a essere quelle piú frequenti.

                \tikzfigure{htb}
                    {\input{../../Figure/.fnl/Capitolo3/AssimmetriaGamma.tex}}
                    {Transizione della densità gamma verso l'asimmetria con \(\lambda=0.1\) ed \(E=\lambda\), da cui \(\langle\hat\gamma\rangle=0.9\) e \(\beta=\langle\hat\gamma\rangle/\alpha\).}
                    {.775\linewidth}{figTransizioneAsimmetria}

                Il risultato è che con \(\sigma\) molto elevato le città tendono a spopolarsi perché v'è una preferenza per fluttuazioni negative. Per ovviare al problema bisogna ulteriormente vincolare \(\sigma\) dimodoché l'indice di asimmetria
                %
                \begin{equation*}
                    \rho\equiv\frac2{\sqrt{\alpha}}
                \end{equation*}
                %
                sia sufficientemente piccolo; dalla \cref{figTransizioneAsimmetria} si può perciò imporre \(\rho\leq0.2\), cioè
                %
                \begin{equation}
                    \label{eqVincoloSimmetricoTraParametri}
                    \alpha\geq100
                    \;\;\implies\;\;
                    \frac{(1-E)^2}{\sigma^2}\geq100
                    \;\;\implies\;\;
                    \sigma\leq\frac{1-\lambda}{10},
                \end{equation}
                %
                dove, come nella \cref{eqVincoloTraParametri}, si è imposto nell'ultima implicazione il caso peggiore \(E=\lambda\). Dunque il vero limite superiore, per preservare la simmetria, è di un ordine di grandezza inferiore a quello precedentemente stimato.
                
                \begin{oss}
                    Quello qui mostrato è solo un possibile modello stocastico perturbativo; infatti, modificando le \cref{ipFluttuazioni}, se ne può scegliere un altro: ad esempio si può imporre una distribuzione uniforme oppure si può troncare una gaussiana affinché soddisfi il vincolo di positività \cref{eqVincoloPositivitàFluttuazioni}.
                \end{oss}

                Non manca che caratterizzare il tasso d'immigrazione \(I\):

                \begin{ipo}%[Caratterizzazione di \(I\)]
                    Si postula che l'interazione \cref{eqRegoleInterazioneUrbaneEsplicite} conservi [in media] la popolazione totale:
                    %
                    \begin{equation*}
                        s+s_*=\langle s+s_*\rangle=
                        \langle s'+s_*'\rangle
                        \overset{\dimTesto{10}\ref{ipFluttuazioniMediaNulla}}{=}
                        s-sE+s_*+sI,
                        % \ \ \implies\ \ 
                    \end{equation*}
                    %
                    da cui \(E\equiv I\), che è ragionevole siccome l'emigrazione e l'immigrazione sono fenomeni relativi (invertendo \(s\) ed \(s_*\) sarebbe l'opposto).
                \end{ipo}

                \begin{oss}
                    Le \cref{eqRegoleInterazioneUrbaneEsplicite} non sono ancora complete siccome non si è esplicitata la regola d'emigrazione, la cui scelta, tuttavia, si può dunque vedere come la regola d'interazione stessa: è l'ultimo tassello del mosaico. Pertanto si lascia quest'ultima definizione al \cref{secRegoleEmigrazione} nel quale se ne propongono varie, si discutono quindi con vari studi parametrici per poi infine interpretarle analizzando cosa queste dicono sul fenomeno della migrazione.
                \end{oss}
            
        \subsection{Equazione di tipo Boltzmann approssimata}\label{secApprossimazione}

            L'approssimazione si fonda sulla seguente matrice:
            
            \begin{dfn}[Matrice dei gradi \(\mathbf B\)]
                \label{defMatriceGradi}
                Sia \(\mathbf B\in\mathbb R^{N\times N}\) una matrice di rango uno
                \[
                    \mathbf B\equiv\frac{\mathbf k^+(\mathbf k^-)^\top}{D_N}
                \]
                definite tramite il prodotto diadico dei vettori
                %
                \begin{equation}
                    \label{eqCriterioApprossimazioneA}
                    \begin{aligned}
                        \mathbf k^+&\equiv(k^+_1,k^+_2,\ldots,k^+_N)^\top=\mathbf A\mathbf 1\in\mathbb R^N,\\
                        \mathbf k^-&\equiv(k^-_1,k^-_2,\ldots,k^-_N)^\top=\mathbf A^\top\mathbf 1\in\mathbb R^N,
                    \end{aligned}
                \end{equation}
                %
                rispettivamente dei gradi uscenti ed entranti, e la costante\footnotemark{}%
                \footnotetext{La \(\Vert\cdot\Vert\) è la norma uno applicata alle matrici: \(\Vert\mathbf A\Vert_1\equiv\sum_{i,j\in\mathcal I}\vert a_{i,j}\vert\).}%
                %
                \begin{equation}
                    \label{eqNormaUnoMatriceAdiacenza}
                    D_N\equiv\sum_{i\in\mathcal I}k^+_i=\mathbf1^\top\mathbf k^+
                    =\sum_{i\in\mathcal I}k^-_i=\mathbf1^\top\mathbf k^-
                    =\mathbf1^\top\mathbf A\mathbf1=\Vert\mathbf A\Vert_1.
                \end{equation}
                %
                Allora \(\mathbf B\) approssima la matrice d'adiacenza \(\mathbf A\) poiché per definizione vale 
                \[
                    \left.\begin{aligned}
                        \mathbf B\mathbf 1
                        &=\frac1{D_N}\mathbf k^+(\mathbf k^-)^\top\mathbf 1
                        =\mathbf k^+\frac{D_N}{D_N}=\mathbf k^+\\
                        \mathbf B^\top\mathbf 1
                        &=\frac1{D_N}\mathbf k^-(\mathbf k^+)^\top\mathbf 1
                        =\mathbf k^-\frac{D_N}{D_N}=\mathbf k^-\
                    \end{aligned}\right\}
                    \ \ \implies\ \ \mathbf B\approx\mathbf A.
                \]
                Inoltre, poiché \(\mathbf A\) è simmetrica (\cref{ipTipoGrafo}) vale \(\mathbf k^+=\mathbf k^-=\mathbf k\) e quindi
                \[
                    \mathbf B=\frac{\mathbf k\mathbf k^\top}{D_N}.
                \]
            \end{dfn}
            
            Tramite la \cref{defMatriceGradi}, la \ref{eqBernoulliInterazioneUrbana} diventa
            %
            \eqtag{\([\text{Ber}]^{\mathbf B}_S\)}{
                \label{eqBernoulliInterazioneUrbanaApprossimata}
                \Theta\sim\DstrBernoulli(B(I,I^*)\Delta t),
            }%
            da cui la \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbano} si legge
            %
            \eqtag{\([\text{EtB}]^{\mathbf B}_S\)}{
                \label{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbanoApprossimata}
                \derS{}t\int_{\mathcal I}\int_{\RPlus}
                \Phi g\de v \de i=
                \int_{\mathcal I^2}\int_{\RPlus^2}B(i,i_*)
                \frac{\langle \Phi'+\Phi_*'-\Phi-\Phi_*\rangle}2
                gg_*\de s\de s_*\de i\de i_*,
            }%
            dove \(g\) e \(g_*\) sono densità definite come la \cref{eqDensitàCongiuntaUrbana} ma indicate diversamente per distinguerle da quelle esatte \(f\) ed \(f_*\).

            Sorge però spontanea una domanda non di poco conto: perché non si può scegliere un'altra matrice \(\mathbf C\in\mathbb R^{N\times N}\) per approssimare la \(\mathbf A\), secondo altri criteri analoghi o dissimili alla \cref{eqCriterioApprossimazioneA}? La risposta non è immediata ma discende in essenza su come la \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbanoApprossimata} può essere riformulata. A tal scopo si necessita di un osservazione:

            \begin{oss}[Teoria e Pratica]
                \label{ossDiscrepanzaTeoriaPratica}
                Come detto nel \cref{secIntroduzione}, l'interesse è di studiare la distribuzione della popolazione tra città; perciò, non a torto, si può vedere la densità \(f\) nella \cref{eqDensitàCongiuntaUrbana} come eccessivamente dettagliata, contenendo informazioni legate ai vertici: ai fini pratici è quindi sufficiente ricavare in qualche modo la densità marginale 
                \( 
                    \bar f(s,t)\equiv\int_{\mathcal I}f(i,s,t)\de i,\ \forall t\geq0,
                \) 
                che è esattamente quanto fatto nel \cref{secMetodoMonteCarlo} per i risultati delle venture simulazioni.
            \end{oss}

            Dall'\cref{ossDiscrepanzaTeoriaPratica} si possono pertanto specializzare gli osservabili:
          
            \begin{ipo}[Osservabili puntuali]
                \label{ipOsservabileUrbanoNodale}
                Si considera la seguente classe di osservabili: 
                \(
                    \Phi(i,s)\equiv\delta(i-j)\varphi(s),\ \forall j\in\mathcal I,
                \) 
                dove \(\varphi:\RPlus\to\mathbb R\) è una funzione arbitraria.
            \end{ipo}
           
            Con tale scelta è possibile recuperare un sistema di equazioni debole per le \(g_i\): usando, infatti, l'\cref{ipOsservabileUrbanoNodale} nella \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbanoApprossimata} porta a
            %
            \begin{equation*}
                \begin{aligned}
                    \derS{}t\int_{\RPlus}\varphi g_j\de s=&
                    \frac1N\int_{\RPlus^2}%\int_{\RPlus}
                    \frac{\langle\varphi'-\varphi\rangle}2
                    g_j\sum_{i\in\mathcal I}B(j,i)g^*_i\de s\de s_*\\&
                    +\frac1N
                    \int_{\RPlus^2}%\int_{\RPlus}
                    \frac{\langle\varphi'_*-\varphi_*\rangle}2
                    s^*_j\sum_{i\in\mathcal I}B(i,j)g_i\de s\de s_*,%\\&
                    \quad\forall j\in\mathcal I,
                \end{aligned}
            \end{equation*}
            %
            ma essendo \(\mathbf B\) simmetrica vale
            %
            \begin{equation*}
                \derS{}t\int_{\RPlus}\varphi g_j\de s=
                \frac1N\int_{\RPlus^2}
                \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                g_j\sum_{i\in\mathcal I}B(j,i)g^*_i\de s\de s_*
                \quad\forall j\in\mathcal I,
            \end{equation*}
            %
            che in forma matriciale, introducendo le densità vettoriali
            %
            \begin{equation*}
                \newcommand\hspc{\hspace{1.5em}}
                \mathbf g\equiv\bigl(g_i\bigr)_{i\in\mathcal I}
                \hspc\text{e}\hspc
                \mathbf g_*\equiv\bigl(g^*_i\bigr)_{i\in\mathcal I},
            \end{equation*}
            %
            si legge
            %
            \begin{equation}
                \label{eqSistemaDensitàNodiUrbano}
                \derS{}t\int_{\RPlus}\varphi\mathbf g\de s=
                \frac1N\int_{\RPlus^2}
                \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                \mathbf g\odot\mathbf B\mathbf g_*\de s\de s_*,
            \end{equation}
            %
            ove \(\odot\) indica il prodotto di Hadamard (prodotto per elementi).

            Il prossimo passo è introdurre la densità globale delle taglie, ossia la densità marginale della \cref{eqDensitàCongiuntaUrbana} rispetto alla popolazione \(s\):
            %
            \begin{equation}
                \label{eqDensitàMarginaleUrbanaS}
                \bar g_N(s,t)
                \equiv\int_{\mathcal I}g(i,s,t)\de i
                % =\frac1N\sum_{j\in\mathcal I}g_j(s,t)
                % \otimes\int_{\mathcal I}\delta(i-j)\de i
                =\frac1N\sum_{i\in\mathcal I}g_i
                =\frac1N\mathbf 1^\top\mathbf g,
            \end{equation}
            %
            ove \(\mathbf 1\equiv(1,1,\ldots,1)\in\mathbb R^N\), che non è che la media tra le densità di \(S_t\) tra tutt'i vertici\footnotemark{}; premoltiplicando la \cref{eqSistemaDensitàNodiUrbano} per \(\frac1N\mathbf 1^\top\) e usando la \cref{eqDensitàMarginaleUrbanaS} si ha%
            \footnotetext{La medesima definizione vale anche per \(\bar f_N\) della \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbano}.}%
            %
            \eqtag{\([\text{E}\bar g]\)}{
                \label{eqDensitàMediaUrbanaS}
                \derS{}t\int_{\RPlus}\varphi\bar g\de s=
                \frac1{N^2}\int_{\RPlus^2}
                \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                \mathbf g^\top\mathbf B\mathbf g_*\de s\de s_*,
            }%
 
            \begin{oss}
                La \ref{eqDensitàMediaUrbanaS} si può anche ottenere usando, in luogo del'\cref{ipOsservabileUrbanoNodale}, direttamente un osservabile indipendente dall'indice \(i\): \(\Phi(i,s)\equiv\varphi(s),\) confermando quanto premesso nell'\cref{ossDiscrepanzaTeoriaPratica}, cioè che la \ref{eqDensitàMediaUrbanaS} si ricava perdendo le informazioni legati agl'indici negli osservabili.
            \end{oss}

            La \ref{eqDensitàMediaUrbanaS} non è ancora un'equazione chiusa per \(\bar g\) per via del secondo membro nel quale \(\mathbf g^\top\mathbf B\mathbf g_*\) richiede sia di conoscere nel dettaglio le connessioni sottostanti del grafo che le distribuzioni della popolazione di ogni città. Tuttavia, avvalendosi della definizione della \(\mathbf B\), la \ref{eqDensitàMediaUrbanaS} diventa
            %
            \begin{equation}
                \label{eqPrimaIntroduzioneDensitàGradi}
                \derS{}t\int_{\RPlus}\varphi\bar g_N\de s=
                \frac1{N^2}\int_{\RPlus^2}
                \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}{2D_N}
                (\mathbf k^\top\mathbf g)(\mathbf k^\top\mathbf g_*)\de s\de s_*,
            \end{equation}
            %
            che richiede d'introdurre una nuova densità di probabilità:

            \begin{dfn}[Densità dei gradi \(\mathbf k\)]
                \label{defDensitàGradi}
                Sia
                \[
                    d_N\colon\RPlus\times\{0,1,\ldots,N\}\times\RPlus\to\RPlus,
                \]
                la densità di probabilità dell'evento che al tempo \(t\) un agente abbia popolazione \(s\) e grado \(k\), definizione che la lega alle \(g_i\) dalla relazione
                \[
                    d_N(s,k,t)=\frac1N\sum_{i\in\mathcal I_k}g_i(s,t),
                \]
                ove
                %
                \begin{equation}
                    \label{eqInsiemeNodiGradok}
                    \mathcal I_k\equiv\{i\in\mathcal I\ |\ k_i=k\}\subseteq\mathcal I
                \end{equation}
                %
                è l'insieme dei nodi con grado \(k\); da essa ne seguono altre due:
                %
                \begin{align}
                    \bar g_N(s,t)
                    &=\frac1N\sum_{i\in\mathcal I}g_i(s,t)
                    =\sum_{k=0}^N\frac1N\sum_{i\in\mathcal I_k}g_i(s,t)
                    =\sum_{k=0}^Nd_N(s,k,t),\label{eqDensitàGradiMarginale}\\
                    \mathbf k^\top\mathbf g(s,t)
                    &=\sum_{i\in\mathcal I}k_ig_i(s,t)
                    =\sum_{k=0}^Nk\sum_{i\in\mathcal I_k}g_i(s,t)
                    =N\sum_{k=0}^Nkd_N(s,k,t).\notag
                \end{align}
                %
                Un analogo discorso vale per le \(f_i\) in luogo delle \(g_i\).
            \end{dfn}

            E dalla \cref{defDensitàGradi} segue la sua normalizzazione:

            \begin{dfn}[Densità dei gradi \(\mathbf k\) normalizzati]
                \label{defDensitàGradiNormalizzata}
                Siano
                \[
                    \underhat k_i\equiv\frac{k_i}N\in\underhat{\mathcal K},\quad\forall i\in\mathcal I,
                \]
                i gradi normalizzati di un generico nodo rappresentativo di \(\mathcal G\), in cui
                \[
                    \underhat{\mathcal K}\equiv\left\{\frac kN\ |\ k=0,1,\ldots,N\right\}\subseteq[0,1]
                \]
                è l'insieme discreto dei gradi normalizzati; allora la densità dei gradi normalizzati
                \[
                    \underhat d_N\colon\RPlus\times\underhat{\mathcal K}\times\RPlus\to\RPlus,
                \]
                è cosí definita
                %
                \begin{equation}
                    \label{eqDensitàGradiNormalizzati}
                    \underhat d_N(s,\underhat k,t)\equiv Nd_N(s,N\underhat k,t).
                \end{equation}
            \end{dfn}

            \begin{oss}
                \label{ossNaturaDensitàGradi}
                Visto che due elementi consecutivi dell'insieme \(\underhat{\mathcal K}\) sono separati da un passo costante e uguale a \(1/N\), si può definire \(\Delta\underhat k\equiv1/N\) che da \cref{eqDensitàGradiNormalizzati} implica
                \[
                    \sum_{\underhat k\in\underhat{\mathcal K}}\int_{\RPlus}
                    \underhat d_N(s,\underhat k,t)\de s\Delta\underhat k
                    =\sum_{k\in\mathcal K}\int_{\RPlus}d_N(s,k,t)\de s=1,\quad\forall t\geq0,
                \]
                cosa che permette di vedere la \(\underhat d_N\) come funzione costante a tratti dei gradi normalizzati \(\underhat k\), e similmente per \(d_N\) (basta definire \(\Delta k\equiv1\)) essendone un mero riscalamento.
            \end{oss}

            \begin{oss}
                L'\cref{ossNaturaDensitàGradi} dà la possibilità anche d'interpretare la \cref{eqDensitàGradiMarginale} come un uguaglianza tra densità marginali: \(\bar g_N=\bar d_N=\bar{\underhat d}_N\).
            \end{oss}

            Con tutte queste definizioni e osservazioni, la \cref{eqPrimaIntroduzioneDensitàGradi} si può riformulare in termini di \(\underhat d_N\)
            %
            \begin{equation*}
                \derS{}t\sum_{k=0}^N\int_{\RPlus}\varphi d_N\de s=
                N^2\sum_{k,k_*=0}^N\int_{\RPlus^2}\frac{kk_*}{D_N}
                \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                d_Nd^*_N\de s\de s_*,
            \end{equation*}
            %
            dove \(k_*\) è il grado associato a \(g_N^*\), e poi in termini di \(\underhat d_N\)
            %
            \begin{equation*}
                \underbrace{
                    \derS{}t\sum_{k\in\underhat{\mathcal K}}\int_{\RPlus}\varphi\underhat d_N\de s\Delta\underhat k
                    \vphantom{\frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}{2D_N}}
                }_{\Circled{\mathrm{I}}} =
                \underbrace{
                    \sum_{\underhat k,\underhat k_*\in\underhat{\mathcal K}}\int_{\RPlus^2}
                    \frac{\underhat k\underhat k_*}{D_N}
                    \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                    \underhat d_N\underhat d^*_N\de s\de s_*.
                }_{\Circled{\mathrm{II}}}
            \end{equation*}
            %
            Il secondo membro si può ulteriormente manipolare moltiplicando e dividendo per \(N^2\) e definendo il grado normalizzato medio
            %
            \begin{equation}
                \label{eqGradoMedio}
                \bar D_N\equiv\frac{D_N}{N^2}=
                \sum_{\underhat k\in\underhat{\mathcal K}}
                \int_{\RPlus}\underhat k\underhat d_N\de s\Delta\underhat k,
            \end{equation}
            %
            da cui
            %
            \begin{equation*}
                \Circled{\mathrm{II}}=
                \sum_{\underhat k,\underhat k_*\in\underhat{\mathcal K}}\int_{\RPlus^2}\frac{\underhat k\underhat k_*}{\bar D_N}
                \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                \underhat d_N\underhat d^*_N\de s\de s_*\Delta\underhat k\Delta\underhat k_*.
            \end{equation*}
            %
            Valutando il limite \(N\to\infty\) alla \cref{eqGradoMedio} e ai membri \(\Circled{\mathrm I}\) e \(\Circled{\mathrm{II}}\)
            %
            \begin{equation*}
                \begin{aligned}
                    \cref{eqGradoMedio}&\xrightarrow{N\to\infty}
                    \bar D\equiv\int_0^1\int_{\RPlus}\underhat k\underhat d\ \de s\de\underhat k,
                    \hspace{1.5em}\Circled{\mathrm I}\xrightarrow{N\to\infty}
                    \derS{}t\int_0^1\int_{\RPlus}\varphi\underhat d\ \de s\de\underhat k\\
                    \Circled{\mathrm{II}}&\xrightarrow{N\to\infty}
                    \int_0^1\int_0^1\int_{\RPlus^2}\frac{\underhat k\underhat k_*}{\bar D}
                    \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                    \underhat d\underhat d^*\ \de s\de s_*\de\underhat k\de\underhat k_*,
                \end{aligned}
            \end{equation*}
            %
            si perviene infine a un'equazione di tipo Boltzmann:
            %
            \eqtag{\([\text{EtB}]^k_S\)}{
                \label{eqTipoBoltzmannGrafoRilassato}
                \derS{}t\int_0^1\int_{\RPlus}\hspace{-1em}\varphi\underhat d\ \de s\de\underhat k=
                \int_0^1\int_0^1\int_{\RPlus^2}\hspace{-0.5em}\frac{\underhat k\underhat k_*}{\bar D}
                \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                \underhat d\underhat d^*\ \de s\de s_*\de\underhat k\de\underhat k_*.
            }%

            Si è dunque dimostrato il seguente teorema:

            \begin{teo}[di rilassamento della topologia]
                \label{teoRilassamentoTopologia}
                La \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbanoApprossimata} è formalmente equivalente nel limite \(N\to\infty\) a un'equazione di tipo Boltzmann di forma \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico} con microstato \(\mathbf X_t\equiv\{\underhat K,S_t\}\), ove \(\underhat K\in[0,1]\) è la variabile aleatoria dei gradi normalizzati, osservabili \(\varphi(s)\) indipendenti da \(\underhat k\) e nucleo d'interazione \(\mu(\underhat k,\underhat k_*)\equiv(\underhat k\underhat k_*)/\bar D\).
            \end{teo}
            
            Il significato del \cref{teoRilassamentoTopologia} è profondo: approssimare \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbano} con \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbanoApprossimata} coincide col perdere la distinguibilità indotta dal grafo, rilassando in tal modo la topologia la quale non scompare ma rimane solo come distribuzione dei gradi; tale riduzione è come sfocare i dettagli delle connessioni tra i vertici: si passa da uno specifico grafo a una classe di grafi. Nella \cref{figSchemaRiassuntivoApprosimazione} è presente uno schema riassuntivo del corrente paragrafo.

            \begin{oss}
                Il \cref{teoRilassamentoTopologia} motiva anche il perché non si possa considerare una generica matrice \(\mathbf C\) che approssima la \(\mathbf A\): non è detto che rilassi la topologia portando a un'equazione analoga alla \ref{eqTipoBoltzmannGrafoRilassato}.
            \end{oss}

            \tikzfigure{htb}
                {\input{../../Figure/.fnl/Capitolo3/SchemaRiassuntivoApprossimazione.tex}}
                {Schema riassuntivo del \cref{secApprossimazione}.}
                {\linewidth}{figSchemaRiassuntivoApprosimazione}
            
            \begin{oss}
                La \cref{figSchemaRiassuntivoApprosimazione} contiene al suo interno \(\underhat f\) che ha un'analoga definizione alla \cref{defDensitàGradiNormalizzata}, ma normalizzando gl'indici: siano
                \[
                    \underhat i\equiv\frac iN\in\underhat{\mathcal I},\quad\forall i\in\mathcal I,
                \]
                gl'indici normalizzati di un generico nodo rappresentativo di \(\mathcal G\), in cui
                \[
                    \underhat{\mathcal I}\equiv\left\{\frac iN\ |\ i=0,1,\ldots,N\right\}\subseteq[0,1]
                \]
                è l'insieme discreto degl'indici normalizzati. Allora la \cref{eqDensitàCongiuntaUrbana} normalizzata, per analogia colla \cref{eqDensitàGradiNormalizzati}, si può definire
                \[
                    \underhat f(\underhat i,s,t)=Nf(N\underhat i,s,t)=\sum_{j\in\mathcal I}f_j(s,t)\otimes\delta(N\underhat i-j),
                \]
                ma per la condizione di normalità \(\mathbb P([0,1]\times\RPlus)=1\), \(\forall t\geq0\), deve valere\footnotemark{}%
                \footnotetext{Si ricordi che l'indice \(j\) non è un argomento della densità \(f_j\), quindi può essere cambiato con un altro indice purché sia distinto da tutti gli altri secondo la trasformazione scelta.}%
                \[
                    f_{\underhat j}(s,t)=Nf_j(s,t)\quad\text{ove }j=N\underhat j,
                \]
                anch'essa analoga alla \cref{eqDensitàGradiNormalizzati}; difatti con questa la \(\underhat f\) si scrive
                \[
                    \underhat f(\underhat i,s,t)
                    =\frac1N\sum_{\underhat j\in\underhat{\mathcal I}}f_{\underhat j}(s,t)\otimes\delta(N(\underhat i-\underhat j))
                    =\frac1N\sum_{\underhat j\in\underhat{\mathcal I}}f_{\underhat j}(s,t)\otimes\delta(\underhat i-\underhat j).
                \]
                Con tali definizioni la densità marginale \(\bar f\) si può riformulare mediante il cambio di variabili \(i=N\underhat i\):
                \[
                    \bar f_N
                    =\int_{\mathcal I}f(i,s,t)\de i
                    =\int_{\underhat{\mathcal I}}Nf(\underhat i,s,t)\de\underhat i
                    =\int_{\underhat{\mathcal I}}\underhat f(\underhat i,s,t)\de\underhat i
                    =\underhat{\bar f}_N
                    =\frac1N\sum_{\underhat i\in\underhat{\mathcal I}}f_{\underhat i}(s,t),
                \]
                e, definendo il passo \(\Delta\underhat i\equiv1/N\) tra due indici normalizzati consecutivi, si arriva al limite \(N\to\infty\) a
                \[
                    \bar f_N=\underhat{\bar f}_N
                    =\sum_{\underhat i\in\underhat{\mathcal I}}f_{\underhat i}(s,t)\Delta\underhat i
                    \ \ \xrightarrow{N\to\infty}\ \ 
                    \bar f=\underhat{\bar f}
                    =\int_0^1f_{\underhat i}(s,t)\de\underhat i,
                \]
                mentre la \(\underhat f\) diventa
                \[
                    \underhat f(\underhat i,s,t)
                    =\int_0^1f_{\underhat j}(s,t)\otimes\delta(\underhat i-\underhat j)\de\underhat j
                    =f_{\underhat i}(s,t).
                \]
                Similmente vale per \(\bar g\).
            \end{oss}

            \begin{oss}[Sulla bontà di \(\mathbf A\approx\mathbf B\)]
                Su un aspetto è al momento non ci si può esprimere: quanto bene la \(\mathbf B\) approssima la matrice \(\mathbf A\) in generale? Sarebbe necessario elaborare ulteriormente la teoria per trovare una risposta, obbiettivo, come già detto, non di questa tesi. Tuttavia, euristicamente, si può riflettere in questo modo: con \(N\gg1\) le singole connessioni sono meno importati, per cui vengono meno i dettagli, mentre la panoramica può essere ragionevolmente colta da \(\mathbf B\); ciò suggerirebbe che piú sono i nodi migliore è l'approssimazione \(\mathbf A\approx\mathbf B\). Tale breve riflessione è però solo un intuito, \textit{non} una dimostrazione rigorosa, e dunque anche potenzialmente falsa.
            \end{oss}

            \begin{oss}
                Si veda \cite{Nurisso2024} per la dimostrazione del \cref{teoRilassamentoTopologia} in un contesto delle reti sociali e nel caso di un grafo diretto, non necessariamente simmetrico, oltre che di \ref{eqRegoleInterazione} lineari e simmetriche.
            \end{oss}

        \subsection{Altri nessi distinguibile-indistinguibile}\label{secNessiDI}

            Nel precedente paragrafo si è esplorato come si può "perdere" la struttura sottostante indotta dal grafo passando a una densità dipendente dal grado dei nodi, recuperando in tal modo un'equazione classica di tipo Boltzmann. Risulta perciò stimolante esplorare se sussitano certe ipotesi che permettano di trasformare la \ref{eqDensitàMediaUrbanaS} in una forma della \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico}, approfondendo cosí i legami tra la teoria retale sviluppata nei due previ due paragrafi e la teoria di tipo Botlzmann.

            \subsubsection{Ipotesi semplificative}

                A questo scopo valgono le seguenti:

                \begin{ipo}
                    Esistono tre principali ipotesi semplificative della \ref{eqDensitàMediaUrbanaS}:

                    \begin{enumerate}[
                        label=S\arabic*,
                        % topsep=0.5em,
                        % parsep=0em,
                        % itemsep=0.25em,
                        % leftmargin=2.5em,
                        % rightmargin=1.5em,
                        % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                        %itemindent=!,
                        % labelindent=1em,
                        %labelwidth=!,
                        %labelsep=!,
                    ]
                        \item\label{ipMatriceUnitaria} Il grafo è completamente connesso con matrice d'adiacenza unitaria:
                            \[
                                \mathbf A\equiv\mathbb1
                                \ \ \iff\ \ 
                                a_{i,j}\equiv1
                                \quad\forall i,j\in\mathcal I.
                            \]
                        \item\label{ipAgentiIndistinguibili} Gli agenti sono indistinguibili rispetto al grafo:
                            \[
                                f_i(s,t)=f_j(s,t)=f(s,t)
                                \quad\forall i,j\in\mathcal I,
                            \]
                        \item\label{ipInterazioniSimmetriche} Le regole d'interazione \ref{eqRegoleInterazioneUrbane} sono simmetriche (\cref{defLeggiInterazioneSimmetriche}).
                    \end{enumerate}
                \end{ipo}

            \subsubsection{Analisi della \texorpdfstring{\ref{ipMatriceUnitaria}}{S1}}

                Notando che \(\mathbf A=\mathbb1=\mathbf1\mathbf1^\top\), la \ref{eqDensitàMediaUrbanaS} diventa
                %
                \begin{equation*}
                    \begin{aligned}
                        \derS{}t\int_{\RPlus}\varphi\bar f\de s
                        &=\frac1{N^2}\int_{\RPlus^2}
                        \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                        \mathbf f^\top\mathbf1\mathbf1^\top\mathbf f_*\de s\de s_*\\
                        &=\frac1{N^2}\int_{\RPlus^2}
                        \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                        (\mathbf1^\top\mathbf f)(\mathbf1^\top\mathbf f_*)\de s\de s_*\\
                        &=\int_{\RPlus^2}
                        \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                        \left(\frac1N\mathbf1^\top\mathbf f\right)
                        \left(\frac1N\mathbf1^\top\mathbf f_*\right)\de s\de s_*,
                    \end{aligned}
                \end{equation*}
                %
                ma ricordando \cref{eqDensitàMarginaleUrbanaS} si arriva a
                %
                \begin{equation}
                    \label{eqTipoBoltzmannConGrafoUnitario}
                    \derS{}t\int_{\RPlus}\varphi\bar f\de s=
                    \int_{\RPlus^2}
                    \frac{\langle\varphi'-\varphi+\varphi'_*-\varphi_*\rangle}2
                    \bar f\bar f_*\de s\de s_*,
                \end{equation}
                %
                la quale è analoga alla classica equazione di tipo Boltzmann \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico} con microstato \(\mathbf X_t\equiv S_t\) scalare, regole d'interazione \ref{eqRegoleInterazioneUrbane} e nucleo d'interazione unitario\footnotemark{} \(\mu\equiv1\) nella \ref{eqBernoulliInterazione}. Ciò significa che con \ref{ipMatriceUnitaria} gli agenti, nonostante siano distinti per il grafo, si possono vedere come indistinguibili purché si consideri la distribuzione media \eqref{eqDensitàMarginaleUrbanaS}.%
                \footnotetext{Tale risultato implica anche che un nucleo di collisione unitario nella \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico} è il corrispettivo di una matrice unitaria nella \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetricoUrbano}.}%

            \subsubsection{Analisi della \texorpdfstring{\ref{ipAgentiIndistinguibili}}{S2}}

                Sotto tal'ipotesi, che equivale coll'assumere
                \begin{equation*}
                    \mathbf f=\mathbf1f
                    \quad\text{e}\quad
                    \mathbf f_*=\mathbf1f_*,
                \end{equation*}
                la \ref{eqDensitàMediaUrbanaS} diventa
                %
                \begin{equation*}
                    \begin{aligned}
                        \derS{}t\int_{\RPlus}\varphi\bar f\de s
                        &=\frac1{N^2}\int_{\RPlus^2}
                        \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                        f\mathbf1^\top\mathbf A\mathbf1f_*\de s\de s_*\\
                        &=\frac{\mathbf1^\top\textbf A\mathbf1}{N^2}\int_{\RPlus^2}
                        \frac{\langle\varphi'+\varphi'_*-\varphi-\varphi_*\rangle}2
                        ff_*\de s\de s_*
                    \end{aligned}
                \end{equation*}
                %
                e rimembrando \cref{eqNormaUnoMatriceAdiacenza} si ottiene
                %
                \begin{equation*}
                    \derS{}t\int_{\RPlus}\varphi f\de s=
                    \int_{\RPlus^2}\frac{D_N}{N^2}
                    \frac{\langle\varphi'-\varphi+\varphi'_*-\varphi_*\rangle}2
                    ff^*\de s\de s_*.
                \end{equation*}
                %
                In questo contesto il rapporto \(D_N/N^2\in[0,1]\) (grado medio normalizzato della rete) rappresenta quanto la rete è topologicamente simile a una completamente connessa\footnotemark{}.%
                \footnotetext{Difatti \(D_N\) è interpretabile come il numero di lati presenti in un grafo diretto e che ha come limite superiore prorio \(N^2\), ossia il numero totale di coppie [e quindi lati] dati \(N\) nodi.}%
               
                Per il resto l'equazione è analoga alla classica equazione di tipo Boltzmann \ref{eqFormaDeboleTipoBoltzmannOmogeneoAssimmetrico} con microstato \(\mathbf X_t\equiv S_t\) scalare, regole d'interazione \ref{eqRegoleInterazioneUrbane} e nucleo d'interazione nella \ref{eqBernoulliInterazione} costante \(\mu\equiv D_N/N^2=\bar D_N\).
                
                Dunque l'indistinguibilità degli agenti ha una notevole conseguenza sulla \ref{eqDensitàMediaUrbanaS}: riassume l'effetto complessivo del grafo al solo coefficiente \(\bar D_N\) il quale, dunque, ne rappresenta gli ultimi bagliori prima di una sua totale scomparsa per la \ref{ipMatriceUnitaria}.

            \subsubsection{Analisi della \texorpdfstring{\ref{ipMatriceUnitaria}, \ref{ipAgentiIndistinguibili} e \ref{ipInterazioniSimmetriche}}{S1, S2 e S3}}

                Visto che vale la \ref{ipMatriceUnitaria} si può partire dalla \eqref{eqTipoBoltzmannConGrafoUnitario} nella quale la densità media \cref{eqDensitàMarginaleUrbanaS} diventa per \ref{ipAgentiIndistinguibili}                %
                %
                \begin{equation*}
                    \bar f(s,t)=\frac1N\sum_{i\in\mathcal I}f_i(s,t)
                    \overset{\ref{ipAgentiIndistinguibili}}=
                    \frac1N\sum_{i\in\mathcal I}f(s,t)=f(s,t),
                \end{equation*}
                %
                ossia la \(\bar f\) coincide con quella di tutti gli agenti\footnotemark{}, essendo questi, appunto, indistinguibili.%
                \footnotetext{Si noti anche che la perdita della dipendenza della distribuzione media dal numero di nodi \(N\) è coerente col limite \(N\to\infty\), sempre ben approssimabile nei casi classici con un numero di agenti \(N\gg1\) [come lo studio di un gas].}%

                In tal modo la \eqref{eqTipoBoltzmannConGrafoUnitario} diventa
                %
                \begin{equation*}
                    \derS{}t\int_{\RPlus}\varphi f\de s=\int_{\RPlus^2}
                    \frac{\langle\varphi'-\varphi+\varphi'_*-\varphi_*\rangle}2
                    ff^*\de s\de s_*,
                \end{equation*}
                %
                che unita all'\ref{ipInterazioniSimmetriche} porta all'equivalenza
                %
                \begin{equation*}
                    \int_{\RPlus^2}
                    \langle\varphi_*'-\varphi_*\rangle ff_*dsds_*
                    =\int_{\RPlus^2}
                    \langle\varphi'-\varphi\rangle ff^*dsds_*,
                \end{equation*}
                %
                dalla quale si ha
                %
                \begin{equation*}
                    \derS{}t\int_{\RPlus}\varphi fds=
                    \int_{\RPlus^2}
                    \langle\varphi'-\varphi\rangle ff^*dsds_*.
                \end{equation*}
                %
                Quest'equazione, come per gli altri casi, è analoga alla classica equazione di tipo Boltzmann simmetrica \cref{eqFormaDeboleTipoBoltzmannOmogeneoSimmetrico} con microstato \(\mathbf X_t\equiv S_t\) scalare, regole d'interazione \ref{eqRegoleInterazioneUrbane} e nucleo d'interazione nella \ref{eqBernoulliInterazione} unitario \(\mu\equiv1\).%
