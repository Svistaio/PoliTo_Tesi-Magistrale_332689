
% !LW recipe=pdfLaTeX ➞ biber ➞ pdfLaTeX
% !TEX root = Principale.tex
% LTeX: language=it

\documentclass[
    a4paper,
    twoside,
    openright,
    titlepage,
    headinclude,
    footinclude,
    BCOR5mm,
    numbers=noenddot,
    cleardoublepage=empty,
    tablecaptionabove,
]{scrreprt}

\input{../Corpo/Pacchetti.tex}
\input{../Corpo/Definizioni.tex}

\begin{document}

    \Frontespizio
    \Dedica

    %%%
    %%%
    %%%

    \tableofcontents
    \linenumbers

    %%%
    %%%
    %%%

    % \part{Introduzione}
    \chapter{Introduzone}

    %%%
    %%%
    %%%

    % \part{Teoria}
    \chapter{\texorpdfstring
        {Teorie cinetiche dei\newline sistemi multiagente}
        {Teorie cinetiche dei sistemi multiagente}%
    }\label{secTCSM}

        \section{Descrizione cinetica}\label{secDescrizioneCinetica} %  d'interazioni mediante da un grafo
            La distribuzione totale presenta la seguente forma
            %
            \begin{equation}
                \label{eqDistribuzioneTotale}
                f(x,s,t)=\frac1N\sum_{i\in\mathcal I}f_i(s,t)\otimes\delta(x-i),
            \end{equation}
            %
            ove \(N\equiv\vert\mathcal I\vert\) è il numero totale d'agenti/vertici del grafo mentre \(\delta(\cdot)\) denota la delta di Dirac centrata all'origine; d'altra parte \[f_i=f_i(s,t):\mathcal P\times[0,+\infty)\rightarrow\mathbb R_+\] è la densità di probabilità della taglia \(S_t\) dell'agente \(X=i\).
            
            Logicamente si richiede
            %
            \begin{equation*}
                % \label{eqUnitaryIntegrationfi}
                \int_{\mathcal P}f_i(s,t)\de s=1,
                \qquad\forall t\geq0,\;\forall i\in\mathcal I,
            \end{equation*}
            %
            che implica coerentemente
            %
            \begin{equation*}
                % \label{eqUnitaryIntegrationf}
                \int_{\mathcal I}\int_{\mathcal P}f(x,s,t)\de s\de x=1
            \end{equation*}
            %
            a ogn'istante.

            [...]

            %
            \begin{equation}
                \label{eqBoltzmannConGrafo}
                \begin{aligned}
                    \derS{}t\int_{\mathcal P}\varphi f_i\de s&=
                    \frac1{2N}\sum_{j\in\mathcal I}A(i,j)
                    \int_{\mathcal P^2}%\int_{\mathcal P}
                    \langle\varphi'-\varphi\rangle
                    f_if^*_j\de s\de s_*\\&
                    +\frac1{2N}\sum_{j\in\mathcal I}A(j,i)
                    \int_{\mathcal P^2}%\int_{\mathcal P}
                    \langle\varphi'_*-\varphi_*\rangle
                    f_jf^*_i\de s\de s_*,%\\&
                    \quad\forall i\in\mathcal I,
                \end{aligned}
            \end{equation}
            %
            ove gli argomenti di tutte le funzioni sono stati sottintesi, vale a dire
            \[
                \newcommand\spazOr{\;\;\;}
                f_i\equiv f_i(s,t)\spazOr\forall i\in\mathcal I,
                \spazOr\varphi\equiv\varphi(s),
                \spazOr\varphi_*\equiv\varphi(s_*)
                \spazOr\text{e}\spazOr
                \varphi'\equiv\varphi(s').
            \]

        \section{Nesso discreto-continuo}\label{secNessoDC}

            È d'interesse esplorare il legame presente tra la \eqref{eqBoltzmannConGrafo} coll'equazione classica di Boltzmann \daRivedere{}.


            \subsection{Ipotesi semplificative}

                A questo scopo si possono fare tre principali ipotesi semplificative da applicare alla \eqref{eqBoltzmannConGrafo}:

                \begin{enumerate}[
                    label=\arabic*\(^\circ\) IS,
                    topsep=7.5pt,
                    parsep=5pt,
                    itemsep=0pt,
                    leftmargin=1cm,
                    rightmargin=0pt,
                    % \leftmargin + \itemindent = \labelindent + \labelwidth + \labelsep
                ]
                    \item\label{ipMatriceUnitaria} Si presuppone che il grafo sia completamente connesso e quindi che la matrice d'adiacenza sia unitaria \(A\equiv I\).
                    %
                    \item\label{ipAgentiIndistinguibili} Si assume che gli agenti siano indistinguibili:
                    %
                    \begin{equation}
                        f_i(s,t)=f_j(s,t)=f(s,t)
                        \quad\forall i,j\in\mathcal I,
                    \end{equation}
                    %
                    \item\label{ipInterazioniSimmetriche} S'ipotizza che le interazioni siano simmetriche:% \(\psi(s,s_*)=\psi_*(s_*,s).\)
                    %
                    \begin{equation}
                        s'=\Psi(s,s_*)=\Psi_*(s_*,s),
                        \;\;\text{ove }s_*=\Psi_*(s,s_*).
                    \end{equation}
                \end{enumerate}


            \newcommand\titoloSez{
                Analisi della %
                \texorpdfstring{%
                % \tref{ipMatriceUnitaria}{\(1^\circ\)}
                \ref{ipMatriceUnitaria}}{1° IS}%
            }
            \subsection{\titoloSez}

                Con tal'ipotesi la \eqref{eqBoltzmannConGrafo} diventa
                %
                \begin{equation*}
	                % \begin{aligned}
                    %     \derS{}t\int_{\mathcal P}\varphi f_i\de s=
                    %     \frac1{2N}\left[\vphantom{\int_{\mathcal P^2}}\right.&
                    %     \smash{\sum_{j\in\mathcal I}}\int_{\mathcal P^2}
                    %     \langle\varphi'-\varphi\rangle f_if^*_j\de s\de s_*\\
                    %     +&\smash{\sum_{j\in\mathcal I}}\int_{\mathcal P^2}
                    %     \langle\varphi'_*-\varphi_*\rangle f_jf^*_i\de s\de s_*
                    %     \left.\vphantom{\int_{\mathcal P^2}}\right],
                    % \end{aligned}
                    %
                    \derS{}t\int_{\mathcal P}\varphi f_i\de s=
                    \frac1{2N}\left[\vphantom{\int_{\mathcal P^2}}\right.
                    \smash{\sum_{j\in\mathcal I}}\int_{\mathcal P^2}
                    \langle\varphi'-\varphi\rangle f_if^*_j\de s\de s_*
                    +\smash{\sum_{j\in\mathcal I}}\int_{\mathcal P^2}
                    \langle\varphi'_*-\varphi_*\rangle f_jf^*_i\de s\de s_*
                    \left.\vphantom{\int_{\mathcal P^2}}\right],
                \end{equation*}
                %
                e valutando la distribuzione marginale della \eqref{eqDistribuzioneTotale} rispetto agl'indici
                %
                \begin{equation}
                    \label{eqDistribuzioneMarginaleIndici}
                    F(s,t)\equiv\int_{\mathcal I}f(x,s,t)\de x=
                    \frac1N\sum_{i\in\mathcal I}f_i(s,t)
                    \otimes\int_{\mathcal I}\delta(x-i)\de x=
                    \frac1N\sum_{i\in\mathcal I}f_i(s,t),
                \end{equation}
                %
                che corrisponde a una media tra le distribuzione dei singoli agenti, si ricava
                %
                \begin{equation*}
                    % \label{}
	                % \begin{aligned}
                    %     \derS{}t\int_{\mathcal P}\varphi f_i\de s=
                    %     \frac1{2N}\left[\vphantom{\int_{\mathcal P^2}}\right.&
                    %     \int_{\mathcal P^2}
                    %     \langle\varphi'-\varphi\rangle f_iF^*\de s\de s_*\\
                    %     +&\int_{\mathcal P^2}
                    %     \langle\varphi'_*-\varphi_*\rangle F_jf^*_i\de s\de s_*
                    %     \left.\vphantom{\int_{\mathcal P^2}}\right],
                    % \end{aligned}
                    %
                    \derS{}t\int_{\mathcal P}\varphi f_i\de s=
                    \frac12\left[\vphantom{\int_{\mathcal P^2}}\right.
                    \int_{\mathcal P^2}
                    \langle\varphi'-\varphi\rangle f_iF^*\de s\de s_*
                    +\int_{\mathcal P^2}
                    \langle\varphi'_*-\varphi_*\rangle Ff^*_i\de s\de s_*
                    \left.\vphantom{\int_{\mathcal P^2}}\right];
                \end{equation*}
                %
                mediando ora rispetto a tutti gli agenti, si ha
                %
                \begin{equation}
                    \label{eqBoltzmannConGrafoUnitario}
                    % \begin{aligned}
                    %     \derS{}t\int_{\mathcal P}\varphi F\de s&=
                    %     \frac1{2N}\left[\vphantom{\int_{\mathcal P^2}}\right.
                    %     \int_{\mathcal P^2}
                    %     \langle\varphi'-\varphi\rangle FF^*\de s\de s_*
                    %     +\int_{\mathcal P^2}
                    %     \langle\varphi'_*-\varphi_*\rangle FF^*\de s\de s_*
                    %     \left.\vphantom{\int_{\mathcal P^2}}\right]\\&=
                    %     \frac1{2N}\int_{\mathcal P^2}
                    %     \langle\varphi'-\varphi+\varphi'_*-\varphi_*\rangle FF^*\de s\de s_*
                    % \end{aligned}
                    \derS{}t\int_{\mathcal P}\varphi F\de s=
                    \frac12\int_{\mathcal P^2}
                    \langle\varphi'-\varphi+\varphi'_*-\varphi_*\rangle
                    FF^*\de s\de s_*,
                \end{equation}
                %
                la quale è formalmente analoga a quella classica di Boltzmann \daRivedere{}. Ciò significa che con tal'ipotesi semplificativa, nonostante gli agenti siano distinti, questi si possono vedere come indistinguibili purché si consideri la distribuzione media \eqref{eqDistribuzioneMarginaleIndici}.

                Tale risultato è anche confermato a livello pratico nell'algoritmo \ref{algMonteCarlo} ove una matrice d'adiacenza unitaria porta ad avere un algoritmo del tutto analogo a quello classico; pertanto l'unica distribuzione che può calcolare \ref{algMonteCarlo} è proprio quella media \(F\).
    
                \newcommand\ave[1]{\left\langle#1\right\rangle}
                \newcommand\bM{\mathbf M}
                \newcommand\cO{\mathcal O}
                \begin{algorithm}[!t]
                    \caption{Algoritmo di Monte Carlo per equazioni di tipo su un grafo}
                    \label{algMonteCarlo}
                    \begin{algorithmic}[1]
                        \Require adjacency matrix \(\bM\); initial state \(V_0\in\cO^N\); time step \(\Delta{t}>0\); final time \(T>0\)
                        \State \(\tilde{V}\gets V_0\)
                        \State \(t\gets 1\)
                        \For{\(t<T\)}
                        \State \(\ave{\varphi}(t)\gets\frac{1}{N}\sum_{i=1}^N\varphi(\tilde{V}(i))\)
                        \State \(V\gets\tilde{V}\)
                        \State \(P\gets \text{random permutation of } \left\{1,\,\dots,\,N\right\}\)
                        \State \(p_1\gets (P(1),\,\dots,\,P(N/2))\)
                        \State \(p_2\gets (P(N/2 + 1),\,\dots,\,P(N))\)
                        \State \(i\gets 1\)
                        \For{\(i<N/2\)}
                        \State \(\Theta\sim\operatorname{Bernoulli}\!\left(B(p_1(i),p_2(i))\Delta{t}\right)\)
                        \State \(\tilde{V}(p_1(i))\gets V(p_1(i))(1-\Theta)+\Psi(V(p_1(i)),V(p_2(i)))\Theta\)
                        \State \(\tilde{V}(p_2(i))\gets V(p_2(i))(1-\Theta)+\Psi_\ast(V(p_2(i)),V(p_1(i)))\Theta\)
                        \State \(i\gets i+1\)
                        \EndFor
                        \State \(t\gets t+\Delta t\)
                        \EndFor
                    \end{algorithmic}
                \end{algorithm}


            \renewcommand\titoloSez{
                Analisi della %
                \texorpdfstring{%
                % \tref{ipAgentiIndistinguibili}{\(2^\circ\)}
                \ref{ipAgentiIndistinguibili}}{2° IS}%
            }
            \subsection{\titoloSez}

                La previa discussione suggerisce di studiare anche il caso in cui gli agenti siano effettivamente indistinguibili; tuttavia, prima di affrontarlo assieme alla prima ipotesi risulta interessante analizzare tale ipotesi isolatamente. Pertanto la \eqref{eqBoltzmannConGrafo} diventa
                %
                \begin{equation*}
                    \begin{aligned}
                        \derS{}t\int_{\mathcal P}\varphi f\de s&=
                        \frac1{2N}\sum_{j\in\mathcal I}A(i,j)
                        \int_{\mathcal P^2}
                        \langle\varphi'-\varphi\rangle
                        ff^*\de s\de s_*\\&
                        +\frac1{2N}\sum_{j\in\mathcal I}A(j,i)
                        \int_{\mathcal P^2}
                        \langle\varphi'_*-\varphi_*\rangle
                        ff^*\de s\de s_*,
                    \end{aligned}
                \end{equation*}
                %
                che sommata su tutti gl'indici porta a
                %
                \begin{equation*}
                    \derS{}t\int_{\mathcal P}\varphi f\de s=
                    \frac1{2N^2}\sum_{i,j\in\mathcal I}A(i,j)
                    \int_{\mathcal P^2}
                    \langle\varphi'-\varphi+\varphi'_*-\varphi_*\rangle
                    ff^*\de s\de s_*,
                \end{equation*}
                %
                e definendo \(L\equiv\sum_{i,j\in\mathcal I}A(i,j)\) si arriva a
                %
                \begin{equation}
                    \label{eqBoltzmannConAgentiIndistinguibili}
                    \derS{}t\int_{\mathcal P}\varphi f\de s=
                    \frac L{N^2}\left[\frac12
                    \smash{\sum_{i,j\in\mathcal I}}A(i,j)
                    \int_{\mathcal P^2}
                    \langle\varphi'-\varphi+\varphi'_*-\varphi_*\rangle
                    ff^*\de s\de s_*\right].
                \end{equation}
                %
                In questo contesto il rapporto \(L/N^2\in[0,1]\) rappresenta topologicamente simile è la rete a una completamente connessa\footnotemark{}; d'altra parte l'equazione è analoga a quella classica di Boltzmann \daRivedere{}.
               
                Dunque l'indistinguibilità degli agenti ha una notevole conseguenza sulla \eqref{eqBoltzmannConGrafo}, riassumendo l'effetto complessivo del grafo al solo coefficiente \(L/N^2\) che quindi ne rappresenta gli ultimi bagliori prima di una sua totale scomparsa per la \ref{ipMatriceUnitaria}.

                \footnotetext{Difatti \(L\) è interpretabile come il numero di lati presenti in un grafo diretto e che ha come limite superiore prorio \(N^2\), ossia il numero totale di coppie [e quindi lati] dati \(N\) nodi.}


            \renewcommand\titoloSez{
                Analisi della %
                \texorpdfstring{%
                \tref{ipMatriceUnitaria}{\(1^\circ\)}, %
                \tref{ipAgentiIndistinguibili}{\(2^\circ\)} e %
                % \tref{ipInterazioniSimmetriche}{\(3^\circ\)}%
                \ref{ipInterazioniSimmetriche}}{1°, 2° e 3° IS}%
            }
            \subsection{\titoloSez}

                Visto che vale \ref{ipMatriceUnitaria} si può partire dalla \eqref{eqBoltzmannConGrafoUnitario} nella quale la distribuzione media \eqref{eqDistribuzioneMarginaleIndici} diventa per \ref{ipAgentiIndistinguibili}                %
                \begin{equation*}
                        F(s,t)=\frac1N\sum_{i\in\mathcal I}f_i(s,t)
                        \overset{\tref{ipAgentiIndistinguibili}{2^\circ}}=
                        \frac1N\sum_{i\in\mathcal I}f(s,t)=f(s,t),
                \end{equation*}
                %
                ossia la \(F\) coincide con quella di tutti gli agenti\footnotemark, essendo questi, appunto, indistinguibili.
                \footnotetext{Si noti anche che la perdita della dipendenza della distribuzione media dal numero di nodi \(N\) è coerente colla situazione in cui \(N\to\infty\), condizione fondamentale analoga a casi classici come lo studio del gas nel quale \(N\gg1\) ben approssima il limite.}

                In tal modo la \eqref{eqBoltzmannConGrafoUnitario} diventa
                %
                \begin{equation*}
                    \derS{}t\int_{\mathcal P}\varphi f\de s=
                    \frac12\int_{\mathcal P^2}
                    \langle\varphi'-\varphi+\varphi'_*-\varphi_*\rangle
                    ff^*\de s\de s_*,
                \end{equation*}
                %
                che unita all \ref{ipInterazioniSimmetriche} porta all'equivalenza (mediante il cambio di variabili \(s_*=s\) e \(s=s_*\))
                %
                \begin{equation*}
                    \int_{\mathcal P^2}
                    \langle\varphi_*'-\varphi_*\rangle ff_*dsds_*
                    =\int_{\mathcal P^2}
                    \langle\varphi'-\varphi\rangle ff^*dsds_*,
                \end{equation*}
                %
                e quindi a
                %
                \begin{equation*}
                    \derS{}t\int_{\mathcal P}\varphi fds=
                    \int_{\mathcal P^2}
                    \langle\varphi'-\varphi\rangle ff^*dsds_*,
                \end{equation*}
                %
                che equivale alla formula classica di Boltzmann con interazioni simmetriche \daRivedere{} usata classicamente per modellizzare la distribuzione dell'energia cinetica tra una popolazione di particelle di un gas.

    %%%
    %%%
    %%%

    % \part{Risultati}
    \chapter{Simulazioni}\label{secSimulazioni}

    %%%
    %%%
    %%%

    % \part{Conclusioni}
    \chapter{Conclusioni}\label{secConclusioni}

    %%%
    %%%
    %%%

    \printbibliography

\end{document}